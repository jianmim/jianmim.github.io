import{b as t,d as e,a4 as a,V as s,W as o,X as l,Y as n,c as i,Z as r,r as c,w as u,L as d,H as p,y as f,N as m,a as y,o as h,e as v,f as g,g as k,h as T,C as _,i as S,j as x,u as C,F as K,K as L,n as b,m as j,t as I,k as $,J as w,a1 as V,_ as z,p as O}from"./index-80b03063.js";import{T as M}from"./sticky.dc4e5318.js";import{u as D}from"./index.b621671f.js";import{u as N}from"./index.38361e72.js";import{u as B}from"./index.a1af8551.js";const E=t({data:{type:e(Object),default:()=>({})},height:Number,stickyOffsetTop:{type:Number,default:0},titleBgColor:String,titleColor:String,titleSize:String,showKeysList:{type:Boolean,default:!0}}),H=z(y({__name:"index-list",props:E,emits:{click:t=>a(t)},setup(t,{emit:e}){const a=t,{componentContentClass:y,contentContainerHeight:z,keysData:O,listData:E,scrollViewTopValue:H,componentKeyListId:U,keyListTipsTopValue:F,currentTouchKeyIndex:Y,currentTouchKeyValue:G,onKeyListTouchStart:J,onKeyListTouchMove:W,onKeyListTouchEnd:X}=((t,e)=>{const a=f(),s=m(),o=`tilc-${s}`,l=`tilkl-${s}`,{getSelectorNodeInfo:n,getSelectorNodeInfos:r}=N(a),y=i((()=>Object.keys(t.data))),h=c([]);u((()=>t.data),(t=>{const e={key:"★",title:"★",data:[]};h.value=Object.entries(t).map((([t,a])=>(e.data=e.data.concat(a.data.filter((t=>null==t?void 0:t.star))),{key:t,title:a.title,data:a.data}))),e.data.length&&(y.value.includes("★")||y.value.unshift("★"),h.value.unshift(e))}),{immediate:!0});const{systemScreenInfo:v}=D(),g=i((()=>t.height||v.height-t.stickyOffsetTop));let k=[];const T=c(0);let _=0;const S=async()=>{try{const t=await r(`.${o}`);_=0,k=t.map((t=>t.top||0))}catch(t){if(_>10)return void(_=0);_++,setTimeout((()=>{S()}),150)}},{currentY:x,updateOptions:C,onTouchStart:K,onTouchMove:L,onTouchEnd:b}=B();let j=0,I=[];const $=async()=>{try{const t=await n(`#${l}`),e=await r(`#${l} .key-value`);_=0,j=t.top||0,I=e.map((t=>({top:(t.top||0)-j,height:t.height||0}))),C({left:t.left,right:t.right,top:t.top,bottom:t.bottom})}catch(t){if(_>10)return void(_=0);_++,setTimeout((()=>{$()}),150)}},w=c(0),V=c(-1),z=i((()=>y.value[V.value])),O=()=>{let t=-1;if(t=I.findLastIndex((t=>t.top<x.value)),-1!==t){const e=I[t];w.value=e.top+e.height/2;const a=k[t];T.value=a-k[0],V.value=t}};return d((()=>{p((()=>{S(),t.showKeysList&&$()}))})),{componentContentClass:o,contentContainerHeight:g,keysData:y,listData:h,scrollViewTopValue:T,componentKeyListId:l,keyListTipsTopValue:w,currentTouchKeyIndex:V,currentTouchKeyValue:z,onKeyListTouchStart:t=>{K(t)},onKeyListTouchMove:t=>{L(t),O()},onKeyListTouchEnd:t=>{b(t),O(),e("click",z.value),V.value=-1}}})(a,e),{ns:Z,titleClass:q,titleStyle:A}=(t=>{const e=s("index-list"),[a,c]=o(l(t,"titleBgColor"),"bg"),[u,d]=o(l(t,"titleColor"),"text"),{sizeType:p}=n(t.titleSize),f=i((()=>{const s=[e.e("title")];return t.titleSize&&"inner"===p.value&&s.push(e.em("title",t.titleSize)),a.value&&s.push(a.value),u.value&&s.push(u.value),s.join(" ")})),m=i((()=>{const e={};return a.value||(e.backgroundColor=c.value||"var(--tn-color-gray-disabled)"),d.value?e.color=d.value:a.value||u.value||(e.color="var(--tn-color-gray)"),t.titleSize&&"custom"===p.value&&(e.fontSize=r(t.titleSize)),e}));return{ns:e,titleClass:f,titleStyle:m}})(a);return(t,e)=>{const a=$,s=w;return h(),v(a,{class:L([C(Z).b()]),style:_({height:`${C(z)}px`})},{default:g((()=>[k(" 列表内容 "),T(s,{class:L([C(Z).e("scroll-view")]),"scroll-y":"","scroll-top":C(H)},{default:g((()=>[T(a,{style:_({paddingTop:`${t.stickyOffsetTop||0}px`})},{default:g((()=>[(h(!0),S(K,null,x(C(E),((e,s)=>(h(),v(a,{key:s,class:L([C(y)])},{default:g((()=>[T(M,{"offset-top":t.stickyOffsetTop},{default:g((()=>[T(a,{class:L([C(q)]),style:_(C(A))},{default:g((()=>[j(I(e.title),1)])),_:2},1032,["class","style"])])),_:2},1032,["offset-top"]),T(a,{class:L([C(Z).e("content")])},{default:g((()=>[(h(!0),S(K,null,x(e.data,((e,s)=>(h(),v(a,{key:s,class:L([C(Z).e("content-item")])},{default:g((()=>[V(t.$slots,"default",{data:e},void 0,!0)])),_:2},1032,["class"])))),128))])),_:2},1032,["class"])])),_:2},1032,["class"])))),128))])),_:3},8,["style"])])),_:3},8,["class","scroll-top"]),k(" 右侧索引 "),t.showKeysList?(h(),v(a,{key:0,id:C(U),class:L([C(Z).e("key-list")]),onTouchstart:b(C(J),["stop","prevent"]),onTouchmove:b(C(W),["stop","prevent"]),onTouchend:b(C(X),["stop","prevent"])},{default:g((()=>[(h(!0),S(K,null,x(C(O),((t,e)=>(h(),v(a,{key:e,class:L([C(Z).e("key-list-value"),"key-value"])},{default:g((()=>[j(I(t),1)])),_:2},1032,["class"])))),128)),k(" 提示框 "),-1!==C(Y)?(h(),v(a,{key:0,class:L([C(Z).e("key-list-tips-value")]),style:_({top:`${C(F)}px`})},{default:g((()=>[j(I(C(G))+" ",1),T(a,{class:"auxiliary-element"})])),_:1},8,["class","style"])):k("v-if",!0)])),_:1},8,["id","class","onTouchstart","onTouchmove","onTouchend"])):k("v-if",!0)])),_:3},8,["class","style"])}}}),[["__scopeId","data-v-1fdfb66f"]]),U=()=>{const t=c({}),e=t=>{const e=[];for(let a=0;a<10;a++){const s=e.filter((t=>t.star)).length,o=Math.random()>.5&&s<1,l=Math.floor(20*Math.random())+1;e.push({id:a,avatar:`https://resource.tuniaokj.com/images/avatar/default/${l}.png`,nickname:`图鸟-员工${t}-${a}`,department:""+(o?"凶姐下属":`${t}部门`),star:o})}return e};return(()=>{for(let a=0;a<26;a++){const s=String.fromCharCode(65+a);t.value[s]={title:s.toUpperCase(),data:e(s)}}t.value["#"]={title:"#",data:[{id:0,avatar:"https://resource.tuniaokj.com/images/avatar/default/1.png",nickname:"图鸟-打杂部-打杂1号",department:"打杂"},{id:1,avatar:"https://resource.tuniaokj.com/images/avatar/default/2.png",nickname:"图鸟UI-打杂部-打杂2号",department:"打杂"},{id:2,avatar:"https://resource.tuniaokj.com/images/avatar/default/3.png",nickname:"图鸟UI-打杂部-打杂3号",department:"打杂"}]}})(),{listData:t}},F=z(y({__name:"index-list-item",props:{avatar:String,nickname:String,department:String},setup:t=>(e,a)=>{const s=O,o=$;return h(),v(o,{class:"index-list-item"},{default:g((()=>[T(o,{class:"avatar"},{default:g((()=>[T(s,{class:"image",src:t.avatar,mode:"aspectFill"},null,8,["src"])])),_:1}),T(o,{class:"info"},{default:g((()=>[T(o,{class:"nickname"},{default:g((()=>[j(I(t.nickname),1)])),_:1}),T(o,{class:"department"},{default:g((()=>[j(I(t.department),1)])),_:1})])),_:1})])),_:1})}}),[["__scopeId","data-v-a3bf53e8"]]);export{F as I,H as T,U as u};

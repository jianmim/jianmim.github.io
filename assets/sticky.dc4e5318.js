import{b as t,V as e,c as s,Z as a,r as o,aj as i,w as n,L as l,H as c,M as u,y as r,N as p,a as d,o as y,e as v,f,h as S,a1 as h,K as k,u as m,C as x,k as b,_ as C}from"./index-80b03063.js";import{Z as g,b as w,a as $}from"./index.b621671f.js";import{u as I}from"./index.38361e72.js";import{u as _}from"./index.ae0678d3.js";const T=t({enabled:{type:Boolean,default:!0},offsetTop:{type:Number,default:0},zIndex:{type:Number,default:g.sticky}}),j=()=>{const t=o(null);return{supportCSSSticky:t,checkCSSStickySupport:async e=>{(()=>{const e=["","-webkit-","-ms-","-moz-","-o-"],s=e.length,a=document.createElement("div");for(let o=0;o<s;o++)if(a.style.position=`${e[o]}sticky`,""!==a.style.position)return void(t.value=!0);t.value=!1})(),t.value||(()=>{const{platform:e,system:s}=i(),a=e.toLowerCase();"android"===a&&Number(s.replace("Android",""))>8||"ios"===a?t.value=!0:t.value=!1})(),t.value}}},z=C(d({__name:"sticky",props:T,emits:{change:t=>w(t)},setup(t){const i=t,{componentId:d,supportCSSSticky:C,stickyStatus:g,stickyDistance:w,stickyContainerRect:T}=(t=>{const e=r(),{emit:a}=e,i=`ts-${p()}`,{supportCSSSticky:d,checkCSSStickySupport:y}=j(),{connectObserver:v,disconnectObserver:f}=_(e),{getSelectorNodeInfo:S}=I(e),h=s((()=>$(null==t?void 0:t.offsetTop,0))),k=o(!1),m=t=>{t?a("change",!0):k.value&&a("change",!1),k.value=t};let x=0;const b=o({width:"auto",height:"auto",left:0}),C=()=>{v(`#${i}`,(e=>{t.enabled&&m(e.boundingClientRect.top<=h.value)}),{type:"relativeToViewport",margins:{top:-h.value}},{thresholds:[.95,.98,1]})},g=async()=>{f();try{const t=await S(`#${i}`);x=0,b.value.width=t.width||0,b.value.height=t.height||0,b.value.left=t.left||0,c((()=>{C()}))}catch(t){if(x>10)return void(x=0);x++,setTimeout((()=>{g()}),150)}};n((()=>d.value),(e=>{!1===e&&t.enabled&&g()})),n((()=>t.offsetTop),(()=>{c((()=>{w()}))})),n((()=>t.enabled),(t=>{t?(f(),C()):(m(!1),f())}));const w=()=>{y(`#${i}`)};return l((()=>{c((()=>{w()}))})),u((()=>{f()})),{componentId:i,supportCSSSticky:d,stickyStatus:k,stickyContainerRect:b,stickyDistance:h}})(i),{ns:z,stickyStyle:N,stickyContentStyle:R}=((t,o,i,n,l)=>({ns:e("sticky"),stickyStyle:s((()=>{const e={};return t.zIndex&&(e.zIndex=t.zIndex),t.enabled?o.value?(e.position="sticky",e.top=`${i.value}px`):e.height=n.value?a(l.value.height,"px"):"auto":e.position="static",e})),stickyContentStyle:s((()=>{const t={};return o.value||(t.position=n.value?"fixed":"static",t.top=`${i.value}px`,t.left=`${l.value.left}px`,t.width=a(l.value.width,"px")),i.value>0&&(t.top=`${i.value}px`),t}))}))(i,C,w,g,T);return(t,e)=>{const s=b;return y(),v(s,{id:m(d),class:k([m(z).b()]),style:x(m(N))},{default:f((()=>[S(s,{class:k([m(z).e("content")]),style:x(m(R))},{default:f((()=>[h(t.$slots,"default",{},void 0,!0)])),_:3},8,["class","style"])])),_:3},8,["id","class","style"])}}}),[["__scopeId","data-v-ceda6692"]]);export{z as T};

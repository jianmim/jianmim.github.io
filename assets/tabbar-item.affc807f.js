import{b as e,d as t,a4 as a,V as l,W as o,X as s,c as i,Z as n,x as u,r,w as d,I as c,z as v,a5 as b,N as h,H as g,a8 as m,y as f,L as p,M as y,a as I,o as x,i as S,h as C,f as w,g as z,u as B,e as k,K as _,C as A,a1 as j,F as $,k as V,_ as N,a2 as T,m as W,t as R,n as E}from"./index-80b03063.js";import{U,C as F}from"./event.5568c9d8.js";import{Z as K,b as Z}from"./index.b621671f.js";import{i as q}from"./is-number.acae358a.js";import{u as H}from"./index.38361e72.js";import{u as L}from"./index.ec111f4e.js";import{T as M}from"./badge.9856adf0.js";const O=e({inactiveColor:String,activeColor:String,iconSize:String,fontSize:String}),X=e({...O,modelValue:{type:[String,Number],default:0},height:{type:String,default:"100rpx"},bgColor:String,frosted:Boolean,topShadow:{type:Boolean,default:!0},switchAnimation:Boolean,fixed:Boolean,placeholder:{type:Boolean,default:!0},safeAreaInsetBottom:{type:Boolean,default:!0},beforeSwitch:{type:t(Function)},zIndex:{type:Number,default:K.tabbar}}),D={[U]:e=>q(e)||a(e),[F]:e=>q(e)||a(e)},G=Symbol("tabbarContextKey"),J=N(I({__name:"tabbar",props:X,emits:D,setup(e,{expose:t}){const a=e,{rectId:u,bulgeRectInfo:p,hasBulgeButton:y,setActiveItemByValue:I}=(e=>{const{emit:t}=f(),{children:a,addChild:l,removeChild:o}=L(),{getSelectorNodeInfo:s}=H(),i=`tt-${h()}`,n=r(-1),u=(e,l=!1)=>{var o;n.value=e;const s=a.value.findIndex((t=>t.uid===e)),i=(null==(o=a.value[s])?void 0:o.name)||s;t(U,i),l&&g((()=>{t(F,i)}))},p=t=>{if(!e.beforeSwitch)return void u(t,!0);const l=a.value.findIndex((e=>e.uid===t)),o=e.beforeSwitch(l);[m(o),Z(o)].includes(!0)&&(m(o)?o.then((e=>{e&&u(t,!0)})):o&&u(t,!0))},y=e=>{var t;if(void 0===e)return void u(a.value[0].uid);let l;"number"==typeof e&&(l=null==(t=a.value)?void 0:t[e]),l||(l=a.value.find((t=>t.name===e))),u(l?l.uid:a.value[0].uid)};d((()=>e.modelValue),(e=>{g((()=>{y(e)}))}));const I=r({width:0,height:0,left:0}),x=r(!1);return c(G,v({...b(e),items:a,activeUid:n,addItem:t=>{void 0!==e.modelValue&&-1===n.value&&(e.modelValue!==t.name&&e.modelValue!==a.value.length||g((()=>{u(t.uid),setTimeout((()=>{-1===n.value&&(n.value=t.uid)}),50)}))),l(t)},removeItem:o,setActiveItem:p,setBulgeCircle:async e=>{const{left:t}=e;try{const a=await s(`#${i}`),{left:l}=a;let o=e.width;(null==e?void 0:e.maxWidth)&&(o=e.maxWidth),I.value.width=.75*o,I.value.height=I.value.width,I.value.left=t-(l||0)+e.width/2,x.value=!0}catch(a){}}})),{rectId:i,hasBulgeButton:x,bulgeRectInfo:I,setActiveItem:p,setActiveItemByValue:y}})(a),{ns:N,tabbarClass:T,tabbarStyle:W,bgClass:R,bgStyle:E,placeholderStyle:K,bulgeClass:q,bulgeStyle:M}=(e=>{const t=l("tabbar"),[a,u]=o(s(e,"bgColor"),"bg"),r=i((()=>{const a=[t.b()];return e.fixed&&a.push(t.m("fixed")),e.safeAreaInsetBottom&&a.push("tn-u-safe-area"),e.topShadow&&a.push(t.m("top-shadow")),a.join(" ")})),d=i((()=>{const t={};return e.zIndex&&(t.zIndex=e.zIndex),e.height&&(t.height=n(e.height)),t})),c=i((()=>{const l=[t.e("bg")];return a.value&&!e.frosted&&l.push(a.value),e.frosted&&l.push(t.em("bg","frosted")),l.join(" ")})),v=i((()=>{const t={};return e.zIndex&&(t.zIndex=e.zIndex-1),a.value||(t.backgroundColor=u.value||"var(--tn-color-white)"),e.frosted&&(t.backgroundColor=u.value||"rgba(255, 255, 255, 0.5)"),t})),b=i((()=>{const t={};return e.zIndex&&(t.zIndex=e.zIndex-2),e.height&&(t.height=n(e.height)),t})),h=i((()=>{const l=[t.e("bulge")];return e.topShadow&&l.push(t.em("bulge","top-shadow")),a.value&&!e.frosted&&l.push(a.value),e.frosted&&l.push(t.em("bulge","frosted")),l.join(" ")})),g=i((()=>{const t={};return e.zIndex?t.zIndex=e.zIndex-1:t.zIndex="inherit",a.value||(t.backgroundColor=u.value||"var(--tn-color-white)"),e.frosted&&(t.backgroundColor=u.value||"rgba(255, 255, 255, 0.5)"),t}));return{ns:t,tabbarClass:r,tabbarStyle:d,bgClass:c,bgStyle:v,placeholderStyle:b,bulgeClass:h,bulgeStyle:g}})(a);return t({setActiveItem:I}),(e,t)=>{const a=V;return x(),S($,null,[C(a,{id:B(u),class:_([B(T)]),style:A(B(W))},{default:w((()=>[z(" 凸起按钮 "),B(y)?(x(),k(a,{key:0,class:_([B(q)]),style:A({width:`${B(p).width}px`,height:`${B(p).height}px`,left:`${B(p).left}px`,top:`-${.35*B(p).height}px`,...B(M)})},null,8,["class","style"])):z("v-if",!0),z(" 背景颜色 "),C(a,{class:_([B(R)]),style:A(B(E))},null,8,["class","style"]),z(" 内容 "),C(a,{class:_([B(N).e("content"),{"tn-u-safe-area":e.safeAreaInsetBottom}])},{default:w((()=>[j(e.$slots,"default",{},void 0,!0)])),_:3},8,["class"])])),_:3},8,["id","class","style"]),z(" 占位容器 "),e.fixed&&e.placeholder?(x(),k(a,{key:0,class:_([B(N).e("placeholder"),{"tn-u-safe-area":e.safeAreaInsetBottom}]),style:A(B(K))},null,8,["class","style"])):z("v-if",!0)],64)}}}),[["__scopeId","data-v-f4fcbbc9"]]),P=N(I({__name:"tabbar-item",props:e({...O,name:{type:[String,Number]},icon:String,activeIcon:String,text:String,bulge:Boolean,bulgeBgColor:String,bulgeTextColor:String,badge:{type:[String,Number]},badgeConfig:{type:t(Object),default:()=>({})},disabled:Boolean}),emits:{click:()=>!0},setup(e,{emit:t}){const a=e,{itemId:d,isActive:c,itemRectInfo:v,iconSize:b,hasBadge:m,itemClick:I}=((e,t)=>{const a=u(G),l=f(),o=l.uid||h(),s=`tti-${o}`,{getSelectorNodeInfo:n}=H(l),d=i((()=>(null==a?void 0:a.activeUid)===o)),c=i((()=>e.iconSize||(null==a?void 0:a.iconSize)||"")),v=i((()=>!!e.badge)),b=r({width:0,height:0,left:0});let m=0;const I=async()=>{try{const e=await n(`#${s}`);if(e.width&&e.width<30)throw new Error("获取TabbarItem节点宽度失败");m=0,b.value.width=e.width||0,b.value.height=e.height||0,b.value.left=e.left||0,b.value.width>80&&(b.value.maxWidth=80),null==a||a.setBulgeCircle(b.value)}catch(e){if(m>10)return void(m=0);m++,setTimeout((()=>{I()}),150)}};return null==a||a.addItem({uid:o,name:e.name}),p((()=>{g((()=>{e.bulge&&I()}))})),y((()=>{null==a||a.removeItem(o)})),{itemId:s,isActive:d,itemRectInfo:b,iconSize:c,hasBadge:v,itemClick:()=>{d.value||e.disabled||(null==a||a.setActiveItem(o),t("click"))}}})(a,t),{ns:N,tabbarItemClass:U,tabbarItemStyle:F,tabbarItemElementStyle:K,bulgeClass:Z,bulgeStyle:q}=((e,t)=>{const a=l("tabbar-item"),r=u(G),d=i((()=>e.activeColor||(null==r?void 0:r.activeColor))),c=i((()=>e.inactiveColor||(null==r?void 0:r.inactiveColor))),[v,b]=o(c,"text"),[h,g]=o(d,"text"),[m,f]=o(c,"bg"),[p,y]=o(d,"bg"),[I,x]=o(s(e,"bulgeBgColor"),"bg"),[S,C]=o(s(e,"bulgeTextColor"),"text"),w=i((()=>n(e.fontSize||(null==r?void 0:r.fontSize)||""))),z=i((()=>{const l=[a.b()];return t.value?h.value&&l.push(h.value):v.value&&l.push(v.value),(e.icon&&e.activeIcon&&!e.text||e.text&&!e.icon&&!e.activeIcon)&&l.push(a.is("only-element")),t.value&&l.push(a.is("active")),(null==r?void 0:r.switchAnimation)&&l.push(a.is("animation")),l.join(" ")})),B=i((()=>{const e={};return t.value?h.value||(e.color=g.value||"var(--tn-color-primary)"):v.value||(e.color=b.value||"var(--tn-color-gray)"),e})),k=i((()=>e=>{const t={};return"text"===e&&w.value&&(t.fontSize=w.value),t})),_=i((()=>{const l=[a.e("bulge")];return e.bulgeBgColor?I.value&&l.push(I.value):t.value?p.value&&l.push(p.value):m.value&&l.push(m.value),S.value&&l.push(S.value),l.join(" ")})),A=i((()=>a=>{const l={};let o=a.width;return(null==a?void 0:a.maxWidth)&&(o=a.maxWidth),l.width=.5*o+"px",l.height=l.width,l.top=`-${.16*o}px`,e.bulgeBgColor?I.value||(l.backgroundColor=x.value):t.value?p.value||(l.backgroundColor=y.value||"var(--tn-color-primary)"):m.value||(l.backgroundColor=f.value||"var(--tn-color-gray)"),C.value&&(l.color=C.value),l}));return{ns:a,tabbarItemClass:z,tabbarItemStyle:B,tabbarItemElementStyle:k,bulgeClass:_,bulgeStyle:A}})(a,c);return(e,t)=>{const a=V;return x(),k(a,{id:B(d),class:_([B(U)]),style:A(B(F)),onClick:E(B(I),["stop"])},{default:w((()=>[j(e.$slots,"default",{},(()=>[z(" 图标 "),e.bulge?(x(),k(a,{key:0,class:_([B(Z)]),style:A(B(q)(B(v)))},{default:w((()=>[C(T,{name:B(c)?e.activeIcon:e.icon,size:B(b)},null,8,["name","size"])])),_:1},8,["class","style"])):(x(),S($,{key:1},[e.icon&&e.activeIcon?(x(),k(a,{key:0,class:_([B(N).e("icon")]),style:A(B(K)("icon"))},{default:w((()=>[C(T,{name:B(c)?e.activeIcon:e.icon,size:B(b)},null,8,["name","size"]),z(" 角标 "),B(m)?(x(),k(M,{key:0,value:e.badge,dot:e.badgeConfig.dot,size:e.badgeConfig.dot?"16":"",type:"danger"},null,8,["value","dot","size"])):z("v-if",!0)])),_:1},8,["class","style"])):z("v-if",!0)],64)),z(" 文字 "),e.text?(x(),k(a,{key:2,class:_([B(N).e("text")]),style:A(B(K)("text"))},{default:w((()=>[W(R(e.text),1)])),_:1},8,["class","style"])):z("v-if",!0)]),!0)])),_:3},8,["id","class","style","onClick"])}}}),[["__scopeId","data-v-a8b93b69"]]);export{J as T,P as a};

import{g as p,r as J}from"./index-xdJ7pE-g.js";import{S as v}from"./sys-code-gen-api-JhrPjZzh.js";import{S as C}from"./sys-dict-data-api--sEh4YcZ.js";import{S as z}from"./sys-print-api-6YXVWMNB.js";import{k as G,r as K,L as $,p as j,t as n,x as s,M as c,D as e,A as t,O as S,T as x,S as T,a4 as f,a5 as g,G as k,y as b}from"./store-dof5ccn5.js";const W={class:"sys-editCodeGen-container"},X={style:{color:"#fff"}},Y={key:0},Z={class:"dialog-footer"},ee=G({name:"sysEditCodeGen"}),se=G({...ee,props:{title:String,applicationNamespaces:Array},emits:["handleQuery"],setup(L,{expose:I,emit:P}){const w=L,U=P,F=K(),l=$({isShowDialog:!1,ruleForm:{},tableData:[],dbData:[],menuData:[],codeGenTypeList:[],printTypeList:[],printList:[]});j(async()=>{var m;var u=await p(v).apiSysCodeGenDatabaseListGet();l.dbData=u.data.result;let o=await p(J).apiSysMenuListGet();l.menuData=o.data.result??[];let _=await p(C).apiSysDictDataDataListCodeGet("code_gen_create_type");l.codeGenTypeList=_.data.result;let V=await p(C).apiSysDictDataDataListCodeGet("code_gen_print_type");l.printTypeList=V.data.result;let r=await p(z).apiSysPrintPagePost();l.printList=((m=r.data.result)==null?void 0:m.items)??[]});const h=async()=>{if(l.ruleForm.configId==="")return;let u=await p(v).apiSysCodeGenTableListConfigIdGet(l.ruleForm.configId);l.tableData=u.data.result??[];let o=l.dbData.filter(_=>_.configId==l.ruleForm.configId);l.ruleForm.connectionString=o[0].connectionString,l.ruleForm.dbType=o[0].dbType.toString()},A=u=>{l.ruleForm.tableName=u.entityName,l.ruleForm.busName=u.tableComment},q=u=>{var o;l.ruleForm=JSON.parse(JSON.stringify(u)),l.isShowDialog=!0,(o=F.value)==null||o.resetFields()},M=()=>{U("handleQuery"),l.isShowDialog=!1},B=()=>{l.isShowDialog=!1},O=()=>{F.value.validate(async u=>{u&&(l.ruleForm.id!=null&&l.ruleForm.id>0?await p(v).apiSysCodeGenUpdatePost(l.ruleForm):await p(v).apiSysCodeGenAddPost(l.ruleForm),M())})};return I({openDialog:q}),(u,o)=>{const _=n("ele-Edit"),V=n("el-icon"),r=n("el-option"),m=n("el-select"),d=n("el-form-item"),i=n("el-col"),D=n("el-input"),E=n("el-cascader"),Q=n("el-row"),R=n("el-form"),N=n("el-button"),H=n("el-dialog");return s(),c("div",W,[e(H,{modelValue:l.isShowDialog,"onUpdate:modelValue":o[12]||(o[12]=a=>l.isShowDialog=a),draggable:"","close-on-click-modal":!1,width:"700px"},{header:t(()=>[S("div",X,[e(V,{size:"16",style:{"margin-right":"3px",display:"inline","vertical-align":"middle"}},{default:t(()=>[e(_)]),_:1}),S("span",null,x(w.title),1)])]),footer:t(()=>[S("span",Z,[e(N,{onClick:B},{default:t(()=>[T("取 消")]),_:1}),e(N,{type:"primary",onClick:O},{default:t(()=>[T("确 定")]),_:1})])]),default:t(()=>[e(R,{model:l.ruleForm,ref_key:"ruleFormRef",ref:F,"label-width":"auto"},{default:t(()=>[e(Q,{gutter:35},{default:t(()=>[e(i,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:t(()=>[e(d,{label:"库定位器",prop:"configId"},{default:t(()=>[e(m,{modelValue:l.ruleForm.configId,"onUpdate:modelValue":o[0]||(o[0]=a=>l.ruleForm.configId=a),placeholder:"库名",filterable:"",onChange:o[1]||(o[1]=a=>h()),class:"w100"},{default:t(()=>[(s(!0),c(f,null,g(l.dbData,a=>(s(),b(r,{key:a.configId,label:a.configId,value:a.configId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(i,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:t(()=>[e(d,{label:"库类型",prop:"dbType",rules:[{required:!0,message:"描述不能为空",trigger:"blur"}]},{default:t(()=>[e(m,{modelValue:l.ruleForm.dbType,"onUpdate:modelValue":o[2]||(o[2]=a=>l.ruleForm.dbType=a),placeholder:"数据库类型",clearable:"",disabled:"",class:"w100"},{default:t(()=>[e(r,{label:"MySql",value:"0"}),e(r,{label:"SqlServer",value:"1"}),e(r,{label:"Sqlite",value:"2"}),e(r,{label:"Oracle",value:"3"}),e(r,{label:"PostgreSQL",value:"4"}),e(r,{label:"Dm",value:"5"}),e(r,{label:"Kdbndp",value:"6"}),e(r,{label:"Oscar",value:"7"}),e(r,{label:"MySqlConnector",value:"8"}),e(r,{label:"Access",value:"9"}),e(r,{label:"OpenGauss",value:"10"}),e(r,{label:"QuestDB",value:"11"}),e(r,{label:"HG",value:"12"}),e(r,{label:"ClickHouse",value:"13"}),e(r,{label:"GBase",value:"14"}),e(r,{label:"Custom",value:"900"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(i,{xs:24,sm:24,md:24,lg:24,xl:24,class:"mb20"},{default:t(()=>[e(d,{label:"库地址",prop:"connectionString"},{default:t(()=>[e(D,{modelValue:l.ruleForm.connectionString,"onUpdate:modelValue":o[3]||(o[3]=a=>l.ruleForm.connectionString=a),disabled:"",clearable:"",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:t(()=>[e(d,{label:"生成表",prop:"tableName",rules:[{required:!0,message:"生成表不能为空",trigger:"blur"}]},{default:t(()=>[e(m,{modelValue:l.ruleForm.tableName,"onUpdate:modelValue":o[4]||(o[4]=a=>l.ruleForm.tableName=a),onChange:A,"value-key":"value",filterable:"",clearable:"",class:"w100"},{default:t(()=>[(s(!0),c(f,null,g(l.tableData,a=>(s(),b(r,{key:a.entityName,label:a.entityName+" ( "+a.tableName+" ) ["+a.tableComment+"]",value:a},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(i,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:t(()=>[e(d,{label:"业务名",prop:"busName"},{default:t(()=>[e(D,{modelValue:l.ruleForm.busName,"onUpdate:modelValue":o[5]||(o[5]=a=>l.ruleForm.busName=a),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:t(()=>[e(d,{label:"父级菜单",prop:"menuPid"},{default:t(()=>[e(E,{options:l.menuData,props:{checkStrictly:!0,emitPath:!1,value:"id",label:"title"},placeholder:"请选择上级菜单",clearable:"",class:"w100",modelValue:l.ruleForm.menuPid,"onUpdate:modelValue":o[6]||(o[6]=a=>l.ruleForm.menuPid=a)},{default:t(({node:a,data:y})=>[S("span",null,x(y.title),1),a.isLeaf?k("",!0):(s(),c("span",Y," ("+x(y.children.length)+") ",1))]),_:1},8,["options","modelValue"])]),_:1})]),_:1}),e(i,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:t(()=>[e(d,{label:"命名空间",prop:"nameSpace",rules:[{required:!0,message:"请选择命名空间",trigger:"blur"}]},{default:t(()=>[e(m,{modelValue:l.ruleForm.nameSpace,"onUpdate:modelValue":o[7]||(o[7]=a=>l.ruleForm.nameSpace=a),filterable:"",clearable:"",class:"w100",placeholder:"命名空间"},{default:t(()=>[(s(!0),c(f,null,g(w.applicationNamespaces,(a,y)=>(s(),b(r,{key:y,label:a,value:a},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(i,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:t(()=>[e(d,{label:"作者姓名",prop:"authorName"},{default:t(()=>[e(D,{modelValue:l.ruleForm.authorName,"onUpdate:modelValue":o[8]||(o[8]=a=>l.ruleForm.authorName=a),clearable:"",placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:t(()=>[e(d,{label:"生成方式",prop:"generateType"},{default:t(()=>[e(m,{modelValue:l.ruleForm.generateType,"onUpdate:modelValue":o[9]||(o[9]=a=>l.ruleForm.generateType=a),filterable:"",class:"w100"},{default:t(()=>[(s(!0),c(f,null,g(l.codeGenTypeList,a=>(s(),b(r,{key:a.value,label:a.value,value:a.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(i,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:t(()=>[e(d,{label:"支持打印",prop:"printType"},{default:t(()=>[e(m,{modelValue:l.ruleForm.printType,"onUpdate:modelValue":o[10]||(o[10]=a=>l.ruleForm.printType=a),filterable:"",class:"w100"},{default:t(()=>[(s(!0),c(f,null,g(l.printTypeList,a=>(s(),b(r,{key:a.value,label:a.value,value:a.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l.ruleForm.printType=="custom"?(s(),b(i,{key:0,xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:t(()=>[e(d,{label:"打印模版",prop:"printName"},{default:t(()=>[e(m,{modelValue:l.ruleForm.printName,"onUpdate:modelValue":o[11]||(o[11]=a=>l.ruleForm.printName=a),filterable:"",class:"w100"},{default:t(()=>[(s(!0),c(f,null,g(l.printList,a=>(s(),b(r,{key:a.id,label:a.name,value:a.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})):k("",!0)]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});export{se as _};

import L from"./regionTree-iZYDq3A2.js";import{_ as F}from"./editRegion.vue_vue_type_script_setup_true_name_sysEditRegion_lang-y7bD9GOs.js";import{g as b}from"./index-lw7p-_pG.js";import{S as P}from"./sys-region-api-ScNmIeRk.js";import{k as x,r as R,L as H,p as I,t as l,a6 as C,x as s,M as O,D as a,A as t,B as p,y as u,S as m,ai as k,E as G,aB as J}from"./store-mQZkmHj-.js";import"./_plugin-vue_export-helper-x3n3nnut.js";const K={class:"sys-region-container"},W=x({name:"sysRegion"}),ne=x({...W,setup(X){const h=R(),v=R(),e=H({loading:!1,regionData:[],queryParams:{id:-1,pid:void 0,name:void 0,code:void 0},tableParams:{page:1,pageSize:20,total:0},editRegionTitle:""});I(()=>{r()});const r=async()=>{var g,_;e.loading=!0;let n=Object.assign(e.queryParams,e.tableParams);var o=await b(P).apiSysRegionPagePost(n);e.regionData=((g=o.data.result)==null?void 0:g.items)??[],e.tableParams.total=(_=o.data.result)==null?void 0:_.total,e.loading=!1},S=()=>{e.queryParams.id=-1,e.queryParams.pid=void 0,e.queryParams.name=void 0,e.queryParams.code=void 0,r()},q=()=>{var n;e.editRegionTitle="添加行政区域",(n=h.value)==null||n.openDialog({orderNo:100})},z=n=>{var o;e.editRegionTitle="编辑行政区域",(o=h.value)==null||o.openDialog(n)},T=n=>{k.confirm(`确定删除行政区域：【${n.name}】?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{var o;await b(P).apiSysRegionDeletePost({id:n.id}),r(),(o=v.value)==null||o.initTreeData(),G.success("删除成功")}).catch(()=>{})},B=async n=>{e.queryParams.pid=n.id,e.queryParams.name=void 0,e.queryParams.code=void 0,r()},D=async()=>{k.confirm("确认同步国家统计局行政区域数据？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{J({title:"提示",message:"后台努力同步中...",type:"success",position:"bottom-right"}),await b(P).apiSysRegionSyncPost({timeout:1e3*60*30})}).catch(()=>{})},V=n=>{e.tableParams.pageSize=n,r()},E=n=>{e.tableParams.page=n,r()};return(n,o)=>{const g=l("el-col"),_=l("el-input"),y=l("el-form-item"),d=l("el-button"),N=l("el-button-group"),A=l("el-form"),w=l("el-card"),c=l("el-table-column"),M=l("el-table"),U=l("el-pagination"),$=l("el-row"),f=C("auth"),Q=C("loading");return s(),O("div",K,[a($,{gutter:8,style:{width:"100%"}},{default:t(()=>[a(g,{span:6,xs:24},{default:t(()=>[a(L,{ref_key:"regionTreeRef",ref:v,onNodeClick:B},null,512)]),_:1}),a(g,{span:18,xs:24},{default:t(()=>[a(w,{shadow:"hover","body-style":{paddingBottom:"0"}},{default:t(()=>[a(A,{model:e.queryParams,ref:"queryForm",inline:!0},{default:t(()=>[a(y,{label:"行政名称"},{default:t(()=>[a(_,{modelValue:e.queryParams.name,"onUpdate:modelValue":o[0]||(o[0]=i=>e.queryParams.name=i),placeholder:"行政名称",clearable:""},null,8,["modelValue"])]),_:1}),a(y,{label:"行政代码"},{default:t(()=>[a(_,{modelValue:e.queryParams.code,"onUpdate:modelValue":o[1]||(o[1]=i=>e.queryParams.code=i),placeholder:"行政代码",clearable:""},null,8,["modelValue"])]),_:1}),a(y,null,{default:t(()=>[a(N,null,{default:t(()=>[p((s(),u(d,{type:"primary",icon:"ele-Search",onClick:r},{default:t(()=>[m(" 查询 ")]),_:1})),[[f,"sysRegion:page"]]),a(d,{icon:"ele-Refresh",onClick:S},{default:t(()=>[m(" 重置 ")]),_:1})]),_:1})]),_:1}),a(y,null,{default:t(()=>[p((s(),u(d,{type:"primary",icon:"ele-Plus",onClick:q},{default:t(()=>[m(" 新增 ")]),_:1})),[[f,"sysRegion:add"]]),p((s(),u(d,{type:"danger",icon:"ele-Lightning",onClick:D},{default:t(()=>[m(" 同步统计局 ")]),_:1})),[[f,"sysRegion:sync"]])]),_:1})]),_:1},8,["model"])]),_:1}),a(w,{class:"full-table",shadow:"hover",style:{"margin-top":"8px"}},{default:t(()=>[p((s(),u(M,{data:e.regionData,style:{width:"100%"},"row-key":"id","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"},border:""},{default:t(()=>[a(c,{prop:"name",label:"行政名称",align:"center","show-overflow-tooltip":""}),a(c,{prop:"code",label:"行政代码",align:"center","show-overflow-tooltip":""}),a(c,{prop:"cityCode",label:"区号",align:"center","show-overflow-tooltip":""}),a(c,{prop:"orderNo",label:"排序",width:"70",align:"center","show-overflow-tooltip":""}),a(c,{prop:"remark",label:"备注","header-align":"center","show-overflow-tooltip":""}),a(c,{label:"操作",width:"140",fixed:"right",align:"center","show-overflow-tooltip":""},{default:t(i=>[p((s(),u(d,{icon:"ele-Edit",size:"small",text:"",type:"primary",onClick:j=>z(i.row)},{default:t(()=>[m(" 编辑 ")]),_:2},1032,["onClick"])),[[f,"sysRegion:update"]]),p((s(),u(d,{icon:"ele-Delete",size:"small",text:"",type:"danger",onClick:j=>T(i.row)},{default:t(()=>[m(" 删除 ")]),_:2},1032,["onClick"])),[[f,"sysRegion:delete"]])]),_:1})]),_:1},8,["data"])),[[Q,e.loading]]),a(U,{currentPage:e.tableParams.page,"onUpdate:currentPage":o[2]||(o[2]=i=>e.tableParams.page=i),"page-size":e.tableParams.pageSize,"onUpdate:pageSize":o[3]||(o[3]=i=>e.tableParams.pageSize=i),total:e.tableParams.total,"page-sizes":[10,20,50,100],small:"",background:"",onSizeChange:V,onCurrentChange:E,layout:"total, sizes, prev, pager, next, jumper"},null,8,["currentPage","page-size","total"])]),_:1})]),_:1})]),_:1}),a(F,{ref_key:"editRegionRef",ref:h,title:e.editRegionTitle,onHandleQuery:r},null,8,["title"])])}}});export{ne as default};

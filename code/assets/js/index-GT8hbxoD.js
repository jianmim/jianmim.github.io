import{c as j}from"./commonFunction-gGlUyf--.js";import{_ as H}from"./editNotice.vue_vue_type_script_setup_true_name_sysNoticeEdit_lang-JHa4gWPN.js";import{g as w}from"./index-zQlakb1H.js";import{S as h}from"./sys-notice-api-Ah_QpBKb.js";import{k as S,r as I,L,p as O,t as i,a6 as k,x as s,M as G,D as t,A as a,B as _,y as c,S as r,T as J,F as K,ai as C,E as x}from"./store-dof5ccn5.js";import"./formatTime-sb5Dmd3Z.js";import"./index.vue_vue_type_script_setup_true_name_wngEditor_lang-W33iFKCf.js";import"./sys-file-api-qmAEMBR-.js";const W={class:"sys-notice-container"},X=S({name:"sysNotice"}),se=S({...X,setup(Y){const b=I(),{removeHtml:z}=j(),e=L({loading:!1,noticeData:[],queryParams:{title:void 0,type:void 0},tableParams:{page:1,pageSize:20,total:0},editNoticeTitle:""});O(async()=>{p()});const p=async()=>{var y,u;e.loading=!0;let l=Object.assign(e.queryParams,e.tableParams);var n=await w(h).apiSysNoticePagePost(l);e.noticeData=((y=n.data.result)==null?void 0:y.items)??[],e.tableParams.total=(u=n.data.result)==null?void 0:u.total,e.loading=!1},T=()=>{e.queryParams.title=void 0,e.queryParams.type=void 0,p()},D=()=>{var l;e.editNoticeTitle="添加通知公告",(l=b.value)==null||l.openDialog({type:1})},q=l=>{var n;e.editNoticeTitle="编辑通知公告",(n=b.value)==null||n.openDialog(l)},B=l=>{C.confirm(`确定删除通知公告：【${l.title}】?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await w(h).apiSysNoticeDeletePost({id:l.id}),p(),x.success("删除成功")}).catch(()=>{})},V=l=>{C.confirm(`确定发布通知公告：【${l.title}】，不可撤销?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await w(h).apiSysNoticePublicPost({id:l.id}),p(),x.success("发布成功")}).catch(()=>{})},E=l=>{e.tableParams.pageSize=l,p()},$=l=>{e.tableParams.page=l,p()};return(l,n)=>{const y=i("el-input"),u=i("el-form-item"),v=i("el-option"),U=i("el-select"),m=i("el-button"),A=i("el-button-group"),M=i("el-form"),P=i("el-card"),d=i("el-table-column"),g=i("el-tag"),F=i("el-table"),Q=i("el-pagination"),f=k("auth"),R=k("loading");return s(),G("div",W,[t(P,{shadow:"hover","body-style":{paddingBottom:"0"}},{default:a(()=>[t(M,{model:e.queryParams,ref:"queryForm",inline:!0},{default:a(()=>[t(u,{label:"标题"},{default:a(()=>[t(y,{modelValue:e.queryParams.title,"onUpdate:modelValue":n[0]||(n[0]=o=>e.queryParams.title=o),placeholder:"标题",clearable:""},null,8,["modelValue"])]),_:1}),t(u,{label:"类型"},{default:a(()=>[t(U,{modelValue:e.queryParams.type,"onUpdate:modelValue":n[1]||(n[1]=o=>e.queryParams.type=o),placeholder:"类型",clearable:""},{default:a(()=>[t(v,{label:"通知",value:1}),t(v,{label:"公告",value:2})]),_:1},8,["modelValue"])]),_:1}),t(u,null,{default:a(()=>[t(A,null,{default:a(()=>[_((s(),c(m,{type:"primary",icon:"ele-Search",onClick:p},{default:a(()=>[r(" 查询 ")]),_:1})),[[f,"sysNotice:page"]]),t(m,{icon:"ele-Refresh",onClick:T},{default:a(()=>[r(" 重置 ")]),_:1})]),_:1})]),_:1}),t(u,null,{default:a(()=>[_((s(),c(m,{type:"primary",icon:"ele-Plus",onClick:D},{default:a(()=>[r(" 新增 ")]),_:1})),[[f,"sysNotice:add"]])]),_:1})]),_:1},8,["model"])]),_:1}),t(P,{class:"full-table",shadow:"hover",style:{"margin-top":"8px"}},{default:a(()=>[_((s(),c(F,{data:e.noticeData,style:{width:"100%"},border:""},{default:a(()=>[t(d,{type:"index",label:"序号",width:"55",align:"center"}),t(d,{prop:"title",label:"标题","header-align":"center","show-overflow-tooltip":""}),t(d,{prop:"content",label:"内容","header-align":"center","show-overflow-tooltip":""},{default:a(o=>[r(J(K(z)(o.row.content)),1)]),_:1}),t(d,{prop:"type",label:"类型",width:"100",align:"center","show-overflow-tooltip":""},{default:a(o=>[o.row.type===1?(s(),c(g,{key:0},{default:a(()=>[r(" 通知 ")]),_:1})):(s(),c(g,{key:1,type:"warning"},{default:a(()=>[r(" 公告 ")]),_:1}))]),_:1}),t(d,{prop:"createTime",label:"创建时间",align:"center","show-overflow-tooltip":""}),t(d,{prop:"status",label:"状态",width:"100",align:"center","show-overflow-tooltip":""},{default:a(o=>[o.row.status===1?(s(),c(g,{key:0,type:"info"},{default:a(()=>[r(" 已发布 ")]),_:1})):(s(),c(g,{key:1,type:"warning"},{default:a(()=>[r(" 未发布 ")]),_:1}))]),_:1}),t(d,{prop:"publicUserName",label:"发布者",align:"center","show-overflow-tooltip":""}),t(d,{prop:"publicTime",label:"发布时间",align:"center","show-overflow-tooltip":""}),t(d,{label:"操作",width:"200",fixed:"right",align:"center","show-overflow-tooltip":""},{default:a(o=>[_((s(),c(m,{icon:"ele-Position",size:"small",text:"",type:"primary",onClick:N=>V(o.row),disabled:o.row.status===1},{default:a(()=>[r(" 发布 ")]),_:2},1032,["onClick","disabled"])),[[f,"sysNotice:public"]]),_((s(),c(m,{icon:"ele-Edit",size:"small",text:"",type:"primary",onClick:N=>q(o.row),disabled:o.row.status===1},{default:a(()=>[r(" 编辑 ")]),_:2},1032,["onClick","disabled"])),[[f,"sysNotice:update"]]),_((s(),c(m,{icon:"ele-Delete",size:"small",text:"",type:"danger",onClick:N=>B(o.row),disabled:o.row.status===1},{default:a(()=>[r(" 删除 ")]),_:2},1032,["onClick","disabled"])),[[f,"sysNotice:delete"]])]),_:1})]),_:1},8,["data"])),[[R,e.loading]]),t(Q,{currentPage:e.tableParams.page,"onUpdate:currentPage":n[2]||(n[2]=o=>e.tableParams.page=o),"page-size":e.tableParams.pageSize,"onUpdate:pageSize":n[3]||(n[3]=o=>e.tableParams.pageSize=o),total:e.tableParams.total,"page-sizes":[10,20,50,100],small:"",background:"",onSizeChange:E,onCurrentChange:$,layout:"total, sizes, prev, pager, next, jumper"},null,8,["currentPage","page-size","total"])]),_:1}),t(H,{ref_key:"editNoticeRef",ref:b,title:e.editNoticeTitle,onHandleQuery:p},null,8,["title"])])}}});export{se as default};

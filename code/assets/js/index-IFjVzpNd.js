import{k as T,r as v,L as K,p as j,t as i,a6 as P,x as p,M as H,D as a,A as t,U as k,B as N,y as u,S as r,ai as x,E as S}from"./store-dof5ccn5.js";import{_ as L}from"./editCodeGenDialog.vue_vue_type_script_setup_true_name_sysEditCodeGen_lang-L3Plu28l.js";import{_ as F}from"./genConfigDialog.vue_vue_type_script_setup_true_name_sysCodeGenConfig_lang-ZfUrkgwq.js";import{d as O}from"./download-0Y1BJycW.js";import{g}from"./index-xdJ7pE-g.js";import{S as y}from"./sys-code-gen-api-JhrPjZzh.js";import{_ as J}from"./_plugin-vue_export-helper-x3n3nnut.js";import"./sys-dict-data-api--sEh4YcZ.js";import"./sys-print-api-6YXVWMNB.js";import"./fkDialog.vue_vue_type_script_setup_true_name_sysCodeGenFk_lang-k_QRaoVa.js";import"./treeDialog.vue_vue_type_script_setup_true_name_sysCodeGenTree_lang-LcZDoeVI.js";const W={class:"sys-codeGen-container"},X=T({name:"sysCodeGen"}),Y=T({...X,setup(Z){const b=v(),h=v(),e=K({loading:!1,loading1:!1,dbData:[],configId:"",tableData:[],tableName:"",queryParams:{name:void 0,code:void 0,tableName:void 0,busName:void 0},tableParams:{page:1,pageSize:10,total:0},editMenuTitle:"",applicationNamespaces:[]});j(async()=>{s();let l=await g(y).apiSysCodeGenApplicationNamespacesGet();e.applicationNamespaces=l.data.result});const z=l=>{var o;(o=h.value)==null||o.openDialog(l)},s=async()=>{var f,m;e.loading=!0;let l=Object.assign(e.queryParams,e.tableParams),o=await g(y).apiSysCodeGenPagePost(l);e.tableData=((f=o.data.result)==null?void 0:f.items)??[],e.tableParams.total=(m=o.data.result)==null?void 0:m.total,e.loading=!1},D=()=>{e.queryParams.busName=void 0,e.queryParams.tableName=void 0,s()},B=l=>{e.tableParams.pageSize=l,s()},G=l=>{e.tableParams.page=l,s()},q=()=>{var l;e.editMenuTitle="增加",(l=b.value)==null||l.openDialog({authorName:"Admin.NET",generateType:"200",nameSpace:e.applicationNamespaces[0]})},M=l=>{var o;e.editMenuTitle="编辑",(o=b.value)==null||o.openDialog(l)},E=l=>{x.confirm("确定删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await g(y).apiSysCodeGenDeletePost([{id:l.id}]),s(),S.success("操作成功")}).catch(()=>{})},V=l=>{x.confirm("确定要生成吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{var o=await g(y).apiSysCodeGenRunLocalPost(l);o.data.result!=null&&o.data.result.url!=null&&O({url:o.data.result.url}),s(),S.success("操作成功")}).catch(()=>{})};return(l,o)=>{const f=i("el-input"),m=i("el-form-item"),c=i("el-button"),A=i("el-button-group"),R=i("el-form"),C=i("el-card"),d=i("el-table-column"),_=i("el-tag"),U=i("el-table"),$=i("el-pagination"),I=P("auth"),Q=P("loading");return p(),H("div",W,[a(C,{shadow:"hover","body-style":{paddingBottom:"0"}},{default:t(()=>[a(R,{model:e.queryParams,ref:"queryForm",inline:!0},{default:t(()=>[a(m,{label:"业务名",prop:"busName"},{default:t(()=>[a(f,{placeholder:"业务名",clearable:"",onKeyup:k(s,["enter"]),modelValue:e.queryParams.busName,"onUpdate:modelValue":o[0]||(o[0]=n=>e.queryParams.busName=n)},null,8,["modelValue"])]),_:1}),a(m,{label:"数据库表名",prop:"tableName"},{default:t(()=>[a(f,{placeholder:"数据库表名",clearable:"",onKeyup:k(s,["enter"]),modelValue:e.queryParams.tableName,"onUpdate:modelValue":o[1]||(o[1]=n=>e.queryParams.tableName=n)},null,8,["modelValue"])]),_:1}),a(m,null,{default:t(()=>[a(A,null,{default:t(()=>[N((p(),u(c,{type:"primary",icon:"ele-Search",onClick:s},{default:t(()=>[r(" 查询 ")]),_:1})),[[I,"sysMenu:list"]]),a(c,{icon:"ele-Refresh",onClick:D},{default:t(()=>[r(" 重置 ")]),_:1})]),_:1})]),_:1}),a(m,null,{default:t(()=>[a(c,{type:"primary",icon:"ele-Plus",onClick:q},{default:t(()=>[r(" 增加 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(C,{class:"full-table",shadow:"hover",style:{"margin-top":"8px"}},{default:t(()=>[N((p(),u(U,{data:e.tableData,style:{width:"100%"},border:""},{default:t(()=>[a(d,{type:"index",label:"序号",width:"55",align:"center"}),a(d,{prop:"configId",label:"库定位器",align:"center","show-overflow-tooltip":""}),a(d,{prop:"tableName",label:"表名称",align:"center","show-overflow-tooltip":""}),a(d,{prop:"busName",label:"业务名","header-align":"center","show-overflow-tooltip":""}),a(d,{prop:"nameSpace",label:"命名空间","header-align":"center","show-overflow-tooltip":""}),a(d,{prop:"authorName",label:"作者姓名",align:"center","show-overflow-tooltip":""}),a(d,{prop:"generateType",label:"生成方式",align:"center","show-overflow-tooltip":""},{default:t(n=>[n.row.generateType==100?(p(),u(_,{key:0},{default:t(()=>[r(" 下载压缩包 ")]),_:1})):n.row.generateType==111?(p(),u(_,{key:1},{default:t(()=>[r(" 下载压缩包(前端) ")]),_:1})):n.row.generateType==121?(p(),u(_,{key:2},{default:t(()=>[r(" 下载压缩包(后端) ")]),_:1})):n.row.generateType==211?(p(),u(_,{key:3},{default:t(()=>[r(" 生成到本项目(前端) ")]),_:1})):n.row.generateType==221?(p(),u(_,{key:4},{default:t(()=>[r(" 生成到本项目(后端) ")]),_:1})):(p(),u(_,{key:5,type:"danger"},{default:t(()=>[r(" 生成到本项目 ")]),_:1}))]),_:1}),a(d,{label:"操作",width:"200",fixed:"right",align:"center","show-overflow-tooltip":""},{default:t(n=>[a(c,{size:"small",text:"",type:"primary",onClick:w=>V(n.row)},{default:t(()=>[r("开始生成")]),_:2},1032,["onClick"]),a(c,{size:"small",text:"",type:"primary",onClick:w=>z(n.row)},{default:t(()=>[r("配置")]),_:2},1032,["onClick"]),a(c,{size:"small",text:"",type:"primary",onClick:w=>M(n.row)},{default:t(()=>[r("编辑")]),_:2},1032,["onClick"]),a(c,{size:"small",text:"",type:"primary",onClick:w=>E(n.row)},{default:t(()=>[r("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[Q,e.loading]]),a($,{currentPage:e.tableParams.page,"onUpdate:currentPage":o[2]||(o[2]=n=>e.tableParams.page=n),"page-size":e.tableParams.pageSize,"onUpdate:pageSize":o[3]||(o[3]=n=>e.tableParams.pageSize=n),total:e.tableParams.total,"page-sizes":[10,20,50,100],small:"",background:"",onSizeChange:B,onCurrentChange:G,layout:"total, sizes, prev, pager, next, jumper"},null,8,["currentPage","page-size","total"])]),_:1}),a(L,{title:e.editMenuTitle,ref_key:"EditCodeGenRef",ref:b,onHandleQuery:s,"application-namespaces":e.applicationNamespaces},null,8,["title","application-namespaces"]),a(F,{ref_key:"CodeConfigRef",ref:h,onHandleQuery:s},null,512)])}}}),ue=J(Y,[["__scopeId","data-v-35b055ac"]]);export{ue as default};

import Y from"./orgTree-BZB1o17e.js";import{_ as Z}from"./editOrg.vue_vue_type_script_setup_true_name_sysEditOrg_lang-Uezq0U1W.js";import{g as D}from"./index-lw7p-_pG.js";import{S as ee}from"./sys-dict-data-api-XxUIrrBV.js";import{S as O}from"./sys-org-api-I_KY1ixH.js";import{k as L,r as V,L as le,p as te,t as a,a6 as S,x as i,M as B,D as e,A as l,a4 as ae,a5 as oe,S as r,B as b,y as _,T as h,ai as re,E as ne}from"./store-mQZkmHj-.js";import"./_plugin-vue_export-helper-x3n3nnut.js";const se={class:"sys-org-container"},ie=L({name:"sysOrg"}),ge=L({...ie,setup(de){const P=V(),T=V(),t=le({loading:!1,orgData:[],orgTreeData:[],queryParams:{id:0,name:void 0,code:void 0,type:void 0},editOrgTitle:"",orgTypeList:[]});te(async()=>{m();let n=await D(ee).apiSysDictDataDataListCodeGet("org_type");t.orgTypeList=n.data.result});const m=async(n=!1)=>{var u;t.loading=!0;var s=await D(O).apiSysOrgListGet(t.queryParams.id,t.queryParams.name,t.queryParams.code,t.queryParams.type);t.orgData=s.data.result??[],t.loading=!1,n==!0&&((u=T.value)==null||u.initTreeData()),t.queryParams.id==0&&t.queryParams.name==null&&t.queryParams.code==null&&t.queryParams.type==null&&(t.orgTreeData=t.orgData)},F=()=>{t.queryParams.id=0,t.queryParams.name=void 0,t.queryParams.code=void 0,t.queryParams.type=void 0,m()},N=()=>{var n;t.editOrgTitle="添加机构",(n=P.value)==null||n.openDialog({status:1,orderNo:100})},U=n=>{var s;t.editOrgTitle="编辑机构",(s=P.value)==null||s.openDialog(n)},E=n=>{re.confirm(`确定删除机构：【${n.name}】?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await D(O).apiSysOrgDeletePost({id:n.id}),ne.success("删除成功"),m(!0)}).catch(()=>{})},A=async n=>{t.queryParams.id=n.id,t.queryParams.name=void 0,t.queryParams.code=void 0,t.queryParams.type=void 0,m()},R=(n,s,u)=>{var g;return(g=t.orgTypeList.find(c=>c.code==u))==null?void 0:g.value};return(n,s)=>{const u=a("el-col"),g=a("el-input"),c=a("el-form-item"),M=a("el-option"),$=a("el-select"),v=a("el-button"),I=a("el-button-group"),Q=a("el-form"),k=a("el-card"),d=a("el-table-column"),p=a("el-tag"),z=a("ele-InfoFilled"),f=a("el-icon"),y=a("el-text"),x=a("ele-UserFilled"),w=a("el-descriptions-item"),C=a("ele-Calendar"),G=a("ele-Tickets"),H=a("el-descriptions"),j=a("el-popover"),J=a("el-table"),K=a("el-row"),q=S("auth"),W=S("loading");return i(),B("div",se,[e(K,{gutter:8,style:{width:"100%"}},{default:l(()=>[e(u,{span:4,xs:24},{default:l(()=>[e(Y,{ref_key:"orgTreeRef",ref:T,onNodeClick:A},null,512)]),_:1}),e(u,{span:20,xs:24},{default:l(()=>[e(k,{shadow:"hover","body-style":{paddingBottom:"0"}},{default:l(()=>[e(Q,{model:t.queryParams,ref:"queryForm",inline:!0},{default:l(()=>[e(c,{label:"机构名称"},{default:l(()=>[e(g,{modelValue:t.queryParams.name,"onUpdate:modelValue":s[0]||(s[0]=o=>t.queryParams.name=o),placeholder:"机构名称",clearable:""},null,8,["modelValue"])]),_:1}),e(c,{label:"机构编码"},{default:l(()=>[e(g,{modelValue:t.queryParams.code,"onUpdate:modelValue":s[1]||(s[1]=o=>t.queryParams.code=o),placeholder:"机构编码",clearable:""},null,8,["modelValue"])]),_:1}),e(c,{label:"机构类型"},{default:l(()=>[e($,{modelValue:t.queryParams.type,"onUpdate:modelValue":s[2]||(s[2]=o=>t.queryParams.type=o),filterable:"",clearable:"",class:"w100"},{default:l(()=>[(i(!0),B(ae,null,oe(t.orgTypeList,o=>(i(),_(M,{key:o.value,label:o.value,value:o.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(c,null,{default:l(()=>[e(I,null,{default:l(()=>[e(v,{type:"primary",icon:"ele-Search",onClick:m},{default:l(()=>[r(" 查询 ")]),_:1}),e(v,{icon:"ele-Refresh",onClick:F},{default:l(()=>[r(" 重置 ")]),_:1})]),_:1})]),_:1}),e(c,null,{default:l(()=>[b((i(),_(v,{type:"primary",icon:"ele-Plus",onClick:N},{default:l(()=>[r(" 新增 ")]),_:1})),[[q,"sysOrg:add"]])]),_:1})]),_:1},8,["model"])]),_:1}),e(k,{class:"full-table",shadow:"hover",style:{"margin-top":"8px"}},{default:l(()=>[b((i(),_(J,{data:t.orgData,style:{width:"100%"},"row-key":"id","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"},border:""},{default:l(()=>[e(d,{prop:"name",label:"机构名称","min-width":"160","header-align":"center","show-overflow-tooltip":""}),e(d,{prop:"code",label:"机构编码",align:"center","show-overflow-tooltip":""}),e(d,{prop:"level",label:"级别",width:"70",align:"center","show-overflow-tooltip":""}),e(d,{prop:"type",label:"机构类型",align:"center",formatter:R,"show-overflow-tooltip":""}),e(d,{prop:"orderNo",label:"排序",width:"70",align:"center","show-overflow-tooltip":""}),e(d,{label:"状态",width:"70",align:"center","show-overflow-tooltip":""},{default:l(o=>[o.row.status===1?(i(),_(p,{key:0,type:"success"},{default:l(()=>[r("启用")]),_:1})):(i(),_(p,{key:1,type:"danger"},{default:l(()=>[r("禁用")]),_:1}))]),_:1}),e(d,{label:"修改记录",width:"100",align:"center","show-overflow-tooltip":""},{default:l(o=>[e(j,{placement:"bottom",width:"280",trigger:"hover"},{reference:l(()=>[e(y,{type:"primary"},{default:l(()=>[e(f,null,{default:l(()=>[e(z)]),_:1}),r("详情 ")]),_:1})]),default:l(()=>[e(H,{direction:"vertical",column:2,border:""},{default:l(()=>[e(w,{width:"140"},{label:l(()=>[e(y,null,{default:l(()=>[e(f,null,{default:l(()=>[e(x)]),_:1}),r("创建者 ")]),_:1})]),default:l(()=>[e(p,null,{default:l(()=>[r(h(o.row.createUserName??"无"),1)]),_:2},1024)]),_:2},1024),e(w,null,{label:l(()=>[e(y,null,{default:l(()=>[e(f,null,{default:l(()=>[e(C)]),_:1}),r("创建时间 ")]),_:1})]),default:l(()=>[e(p,null,{default:l(()=>[r(h(o.row.createTime??"无"),1)]),_:2},1024)]),_:2},1024),e(w,null,{label:l(()=>[e(y,null,{default:l(()=>[e(f,null,{default:l(()=>[e(x)]),_:1}),r("修改者 ")]),_:1})]),default:l(()=>[e(p,null,{default:l(()=>[r(h(o.row.updateUserName??"无"),1)]),_:2},1024)]),_:2},1024),e(w,null,{label:l(()=>[e(y,null,{default:l(()=>[e(f,null,{default:l(()=>[e(C)]),_:1}),r("修改时间 ")]),_:1})]),default:l(()=>[e(p,null,{default:l(()=>[r(h(o.row.updateTime??"无"),1)]),_:2},1024)]),_:2},1024),e(w,null,{label:l(()=>[e(y,null,{default:l(()=>[e(f,null,{default:l(()=>[e(G)]),_:1}),r("备注 ")]),_:1})]),default:l(()=>[r(" "+h(o.row.remark),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1}),e(d,{label:"操作",width:"140",fixed:"right",align:"center","show-overflow-tooltip":""},{default:l(o=>[b((i(),_(v,{icon:"ele-Edit",size:"small",text:"",type:"primary",onClick:X=>U(o.row)},{default:l(()=>[r(" 编辑 ")]),_:2},1032,["onClick"])),[[q,"sysOrg:update"]]),b((i(),_(v,{icon:"ele-Delete",size:"small",text:"",type:"danger",onClick:X=>E(o.row)},{default:l(()=>[r(" 删除 ")]),_:2},1032,["onClick"])),[[q,"sysOrg:delete"]])]),_:1})]),_:1},8,["data"])),[[W,t.loading]])]),_:1})]),_:1})]),_:1}),e(Z,{ref_key:"editOrgRef",ref:P,title:t.editOrgTitle,orgData:t.orgTreeData,onHandleQuery:m},null,8,["title","orgData"])])}}});export{ge as default};

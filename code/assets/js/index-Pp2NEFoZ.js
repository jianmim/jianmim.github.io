import{B as Y,d as T,g as k}from"./index-lw7p-_pG.js";import{b as L,k as D,L as j,p as H,t as g,a6 as x,x as _,M,D as a,A as c,B as b,y as w,S as f,E as F}from"./store-mQZkmHj-.js";const q=function(o){return{apiSysLogVisClearPost:async(e={})=>{const t="/api/sysLogVis/clear",n=new URL(t,"https://example.com");let r;o&&(r=o.baseOptions);const p={method:"POST",...r,...e},d={},h={};if(o&&o.accessToken){const i=typeof o.accessToken=="function"?await o.accessToken():await o.accessToken;d.Authorization="Bearer "+i}const s=new URLSearchParams(n.search);for(const i in h)s.set(i,h[i]);for(const i in e.params)s.set(i,e.params[i]);n.search=new URLSearchParams(s).toString();let l=r&&r.headers?r.headers:{};return p.headers={...d,...l,...e.headers},{url:n.pathname+n.search+n.hash,options:p}},apiSysLogVisPagePost:async(e,t={})=>{const n="/api/sysLogVis/page",r=new URL(n,"https://example.com");let p;o&&(p=o.baseOptions);const d={method:"POST",...p,...t},h={},s={};if(o&&o.accessToken){const u=typeof o.accessToken=="function"?await o.accessToken():await o.accessToken;h.Authorization="Bearer "+u}h["Content-Type"]="application/json-patch+json";const l=new URLSearchParams(r.search);for(const u in s)l.set(u,s[u]);for(const u in t.params)l.set(u,t.params[u]);r.search=new URLSearchParams(l).toString();let i=p&&p.headers?p.headers:{};d.headers={...h,...i,...t.headers};const y=typeof e!="string"||d.headers["Content-Type"]==="application/json";return d.data=y?JSON.stringify(e!==void 0?e:{}):e||"",{url:r.pathname+r.search+r.hash,options:d}}}},C=function(o){return{async apiSysLogVisClearPost(e){const t=await q(o).apiSysLogVisClearPost(e);return(n=L,r=T)=>{const p={...t.options,url:r+t.url};return n.request(p)}},async apiSysLogVisPagePost(e,t){const n=await q(o).apiSysLogVisPagePost(e,t);return(r=L,p=T)=>{const d={...n.options,url:p+n.url};return r.request(d)}}}};class A extends Y{async apiSysLogVisClearPost(e){return C(this.configuration).apiSysLogVisClearPost(e).then(t=>t(this.axios,this.basePath))}async apiSysLogVisPagePost(e,t){return C(this.configuration).apiSysLogVisPagePost(e,t).then(n=>n(this.axios,this.basePath))}}const N={class:"sys-vislog-container"},E=D({name:"sysVisLog"}),J=D({...E,setup(o){const e=j({loading:!1,queryParams:{startTime:void 0,endTime:void 0},tableParams:{page:1,pageSize:20,total:0},logData:[]});H(async()=>{t()});const t=async()=>{var i,y;e.queryParams.startTime==null&&(e.queryParams.startTime=void 0),e.queryParams.endTime==null&&(e.queryParams.endTime=void 0),e.loading=!0;let s=Object.assign(e.queryParams,e.tableParams);var l=await k(A).apiSysLogVisPagePost(s);e.logData=((i=l.data.result)==null?void 0:i.items)??[],e.tableParams.total=(y=l.data.result)==null?void 0:y.total,e.loading=!1},n=()=>{e.queryParams.startTime=void 0,e.queryParams.endTime=void 0,t()},r=async()=>{e.loading=!0,await k(A).apiSysLogVisClearPost(),e.loading=!1,F.success("清空成功"),t()},p=s=>{e.tableParams.pageSize=s,t()},d=s=>{e.tableParams.page=s,t()},h=[{text:"今天",value:new Date},{text:"昨天",value:()=>{const s=new Date;return s.setTime(s.getTime()-3600*1e3*24),s}},{text:"上周",value:()=>{const s=new Date;return s.setTime(s.getTime()-3600*1e3*24*7),s}}];return(s,l)=>{const i=g("el-date-picker"),y=g("el-form-item"),u=g("el-button"),z=g("el-button-group"),O=g("el-form"),V=g("el-card"),m=g("el-table-column"),v=g("el-tag"),B=g("el-table"),U=g("el-pagination"),S=x("auth"),R=x("loading");return _(),M("div",N,[a(V,{shadow:"hover","body-style":{paddingBottom:"0"}},{default:c(()=>[a(O,{model:e.queryParams,ref:"queryForm",inline:!0},{default:c(()=>[a(y,{label:"开始时间"},{default:c(()=>[a(i,{modelValue:e.queryParams.startTime,"onUpdate:modelValue":l[0]||(l[0]=P=>e.queryParams.startTime=P),type:"datetime",placeholder:"开始时间","value-format":"YYYY-MM-DD HH:mm:ss",shortcuts:h},null,8,["modelValue"])]),_:1}),a(y,{label:"结束时间",prop:"code"},{default:c(()=>[a(i,{modelValue:e.queryParams.endTime,"onUpdate:modelValue":l[1]||(l[1]=P=>e.queryParams.endTime=P),type:"datetime",placeholder:"结束时间","value-format":"YYYY-MM-DD HH:mm:ss",shortcuts:h},null,8,["modelValue"])]),_:1}),a(y,null,{default:c(()=>[a(z,null,{default:c(()=>[b((_(),w(u,{type:"primary",icon:"ele-Search",onClick:t},{default:c(()=>[f(" 查询 ")]),_:1})),[[S,"sysVislog:page"]]),a(u,{icon:"ele-Refresh",onClick:n},{default:c(()=>[f(" 重置 ")]),_:1})]),_:1})]),_:1}),a(y,null,{default:c(()=>[b((_(),w(u,{icon:"ele-DeleteFilled",type:"danger",onClick:r},{default:c(()=>[f(" 清空 ")]),_:1})),[[S,"sysVislog:clear"]])]),_:1})]),_:1},8,["model"])]),_:1}),a(V,{class:"full-table",shadow:"hover",style:{"margin-top":"8px"}},{default:c(()=>[b((_(),w(B,{data:e.logData,style:{width:"100%"},border:""},{default:c(()=>[a(m,{type:"index",label:"序号",width:"55",align:"center"}),a(m,{prop:"displayTitle",label:"显示名称",width:"150",align:"center","show-overflow-tooltip":""}),a(m,{prop:"actionName",label:"方法名称",width:"150","header-align":"center","show-overflow-tooltip":""}),a(m,{prop:"account",label:"账号名称",width:"100",align:"center","show-overflow-tooltip":""}),a(m,{prop:"realName",label:"真实姓名",width:"100",align:"center","show-overflow-tooltip":""}),a(m,{prop:"remoteIp",label:"IP地址",align:"center","show-overflow-tooltip":""}),a(m,{prop:"location",label:"登录地点",align:"center","show-overflow-tooltip":""}),a(m,{prop:"browser",label:"浏览器",align:"center","show-overflow-tooltip":""}),a(m,{prop:"os",label:"操作系统",width:"120",align:"center","show-overflow-tooltip":""}),a(m,{prop:"status",label:"状态",width:"70",align:"center","show-overflow-tooltip":""},{default:c(P=>[P.row.status==="200"?(_(),w(v,{key:0,type:"success"},{default:c(()=>[f("成功")]),_:1})):(_(),w(v,{key:1,type:"danger"},{default:c(()=>[f("失败")]),_:1}))]),_:1}),a(m,{prop:"elapsed",label:"耗时(ms)",width:"90",align:"center","show-overflow-tooltip":""}),a(m,{prop:"logDateTime",label:"日志时间",width:"160",align:"center",fixed:"right","show-overflow-tooltip":""})]),_:1},8,["data"])),[[R,e.loading]]),a(U,{currentPage:e.tableParams.page,"onUpdate:currentPage":l[2]||(l[2]=P=>e.tableParams.page=P),"page-size":e.tableParams.pageSize,"onUpdate:pageSize":l[3]||(l[3]=P=>e.tableParams.pageSize=P),total:e.tableParams.total,"page-sizes":[10,20,50,100],small:"",background:"",onSizeChange:p,onCurrentChange:d,layout:"total, sizes, prev, pager, next, jumper"},null,8,["currentPage","page-size","total"])]),_:1})])}}});export{J as default};

import{k as $,r as m,s as we,L as ge,p as ke,q as _e,t as q,x as u,M as p,G as je,O as r,D as d,F as b,A as xe,a4 as C,a5 as D,i as g,al as ye,E as h,n as k,am as z,ai as Ie,_,Z as A,T as P,P as B,Q as Le}from"./store-dof5ccn5.js";import{a as Ce,u as De}from"./index-xdJ7pE-g.js";import{c as Pe}from"./commonFunction-gGlUyf--.js";import{_ as Ee}from"./_plugin-vue_export-helper-x3n3nnut.js";import"./formatTime-sb5Dmd3Z.js";const Te=[{title:"工作流",icon:"iconfont icon-shouye",isOpen:!0,id:"1",children:[{icon:"iconfont icon-gongju",name:"引擎",id:"11",form:[{type:"input",label:"客户姓名",prop:"name",placeholder:"请输入客户姓名",required:!0,disabled:!1},{type:"select",label:"性别",prop:"sex",placeholder:"请选择性别",required:!0,disabled:!1,options:[{value:"0",label:"女"},{value:"1",label:"男"}]},{type:"input",label:"员工编号",prop:"number",placeholder:"请输入员工编号",required:!0,disabled:!1},{type:"input",label:"办公电话",prop:"mobile",placeholder:"请输入办公电话",required:!0,disabled:!1},{type:"select",label:"权限分配",prop:"role",placeholder:"请选择性别",required:!0,disabled:!1,options:[{value:"0",label:"编辑权限"},{value:"1",label:"删除权限"}]},{type:"checkbox",label:"模块选择",prop:"module",placeholder:"请选择模块",required:!0,disabled:!1}]},{icon:"iconfont icon-shouye_dongtaihui",name:"模版",id:"12",form:[{type:"input",label:"等级",prop:"grade",placeholder:"请输入等级",required:!0,disabled:!1},{type:"input",label:"登记密码",prop:"password",placeholder:"请输入登记密码",required:!0,disabled:!1}]},{icon:"iconfont icon-zhongduancanshuchaxun",name:"名称",id:"13",form:[{type:"input",label:"数据表",prop:"dataSheet",placeholder:"请输入数据表",required:!0,disabled:!1},{type:"input",label:"字段配置",prop:"field",placeholder:"请输入字段配置",required:!0,disabled:!1}]},{icon:"iconfont icon-zhongduancanshu",name:"版本",id:"14",form:[{type:"input",label:"发布模板",prop:"publish",placeholder:"请输入发布模板",required:!0,disabled:!1}]},{icon:"iconfont icon-bolangnengshiyanchang",name:"建模",id:"15",form:[{type:"input",label:"内容模板",prop:"content",placeholder:"请输入内容模板",required:!0,disabled:!1}]},{icon:"iconfont icon-xingqiu",name:"节点",id:"16",form:[{type:"input",label:"活动名称6",prop:"name16"}]}]},{title:"流程",isOpen:!0,icon:"iconfont icon-caijian",id:"2",children:[{icon:"iconfont icon-fuwenben",name:"实例",id:"21",form:[{type:"input",label:"活动名称7",prop:"name21"}]},{icon:"iconfont icon-fuwenbenkuang",name:"轨迹",id:"22",form:[{type:"input",label:"活动名称8",prop:"name22"}]},{icon:"iconfont icon-shangchuan",name:"数据",id:"23",form:[{type:"input",label:"活动名称9",prop:"name23"}]}]},{title:"任务",isOpen:!0,icon:"iconfont icon-shuju",id:"3",children:[{icon:"iconfont icon-icon-",name:"参与人",id:"31",form:[{type:"input",label:"活动名称1",prop:"name31"}]},{icon:"iconfont icon-gerenzhongxin",name:"执行人",id:"32",form:[{type:"input",label:"活动名称2",prop:"name32"}]},{icon:"iconfont icon-fangkuang",name:"工单",id:"33",form:[{type:"input",label:"活动名称3",prop:"name33"}]}]}],ve={Anchors:["Top","TopCenter","TopRight","TopLeft","Right","RightMiddle","Bottom","BottomCenter","BottomRight","BottomLeft","Left","LeftMiddle"],Container:"workflow-right",Connector:["Bezier",{curviness:100}],ConnectionsDetachable:!1,DeleteEndpointsOnDetach:!1,Endpoint:["Blank",{Overlays:""}],EndpointStyle:{fill:"#1879ffa1",outlineWidth:1},LogEnabled:!0,PaintStyle:{stroke:"#E0E3E7",strokeWidth:1,outlineStroke:"transparent",outlineWidth:10},DragOptions:{cursor:"pointer",zIndex:2e3},Overlays:[["Arrow",{width:10,length:8,location:1,direction:1,foldback:.623}],["Label",{label:"",location:.5,cssClass:"aLabel"}]],RenderMode:"svg",HoverPaintStyle:{stroke:"#b0b2b5",strokeWidth:1},EndpointHoverStyle:{fill:"red"},Scope:"jsPlumb_DefaultScope"},Se={filter:".workflow-icon-drag",filterExclude:!1,anchor:"Continuous",allowLoopback:!0,maxConnections:-1},Re={filter:".workflow-icon-drag",filterExclude:!1,anchor:"Continuous",allowLoopback:!0,dropOptions:{hoverClass:"ef-drop-hover"}},E={isSource:!0,isTarget:!0,anchor:"Continuous"},Ne={class:"workflow-container layout-padding"},Oe={key:0,class:"workflow-mask"},Me={class:"layout-padding-auto layout-padding-view workflow-warp"},qe={class:"workflow"},ze={class:"workflow-content"},Ae={class:"workflow-left"},Be=["onClick"],$e=["data-name","data-icon","data-id"],We={class:"workflow-left-item-icon"},Ve={class:"font10 pl5 name"},Fe=["id","data-node-id","onClick","onContextmenu"],He={class:"workflow-left-item-icon"},Je={class:"font10 pl5 name"},Xe=$({name:"pagesWorkflow"}),Ye=$({...Xe,setup(Ue){const W=g(()=>_(()=>import("./index-2I_VfyMC.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url)),T=g(()=>_(()=>import("./index-BU-UcL8B.js"),__vite__mapDeps([7,1,2,5,8]),import.meta.url)),V=g(()=>_(()=>import("./index-svnCK73e.js"),__vite__mapDeps([9,1,2]),import.meta.url)),F=g(()=>_(()=>import("./help-mDTpprs3.js"),__vite__mapDeps([10,1,2]),import.meta.url)),v=m([]),S=m(),R=m(),N=m(),j=m(),O=m(),H=Ce(),J=De(),{themeConfig:X}=we(J),{copyText:Y}=Pe(),e=ge({leftNavList:[],dropdownNode:{x:"",y:""},dropdownLine:{x:"",y:""},isShow:!1,jsPlumb:null,jsPlumbNodeIndex:null,jsplumbDefaults:ve,jsplumbMakeSource:Se,jsplumbMakeTarget:Re,jsplumbConnect:E,jsplumbData:{nodeList:[],lineList:[]}}),x=()=>{document.body.clientWidth<768?e.isShow=!0:e.isShow=!1},U=()=>{e.leftNavList=Te,e.jsplumbData={nodeList:[{nodeId:"huej738hbji",left:"148px",top:"93px",class:"workflow-right-clone",icon:"iconfont icon-gongju",name:"引擎",id:"11"},{nodeId:"52kcszzyxrd",left:"458px",top:"203px",class:"workflow-right-clone",icon:"iconfont icon-shouye_dongtaihui",name:"模版",id:"12"},{nodeId:"nltskl6k4me",left:"164px",top:"350px",class:"workflow-right-clone",icon:"iconfont icon-zhongduancanshuchaxun",name:"名称",id:"13"}],lineList:[{sourceId:"huej738hbji",targetId:"52kcszzyxrd",label:"传送"},{sourceId:"huej738hbji",targetId:"nltskl6k4me",label:""}]}},G=()=>{v.value.forEach(o=>{ye.create(o,{group:{name:"vue-next-admin-1",pull:"clone",put:!1},animation:0,sort:!1,draggable:".workflow-left-item",forceFallback:!0,onEnd:function(l){const{name:t,icon:i,id:n}=l.clone.dataset,{layerX:s,layerY:a,clientX:c,clientY:f}=l.originalEvent,fe=S.value,{x:M,y,width:me,height:be}=fe.getBoundingClientRect();if(c<M||c>me+M||f<y||y>y+be)h.warning("请把节点拖入到画布中");else{const w=Math.random().toString(36).substr(2,12),he={nodeId:w,left:`${s-40}px`,top:`${a-15}px`,class:"workflow-right-clone",name:t,icon:i,id:n};e.jsplumbData.nodeList.push(he),k(()=>{e.jsPlumb.makeSource(w,e.jsplumbMakeSource),e.jsPlumb.makeTarget(w,e.jsplumbMakeTarget,E),e.jsPlumb.draggable(w,{containment:"parent",stop:I=>{e.jsplumbData.nodeList.forEach(L=>{L.nodeId===I.el.id&&(L.left=`${I.pos[0]}px`,L.top=`${I.pos[1]}px`)})}})})}}})})},Q=()=>{z.jsPlumb.ready(()=>{e.jsPlumb=z.jsPlumb.getInstance({detachable:!1,Container:"workflow-right"}),e.jsPlumb.fire("jsPlumbDemoLoaded",e.jsPlumb),e.jsPlumb.importDefaults(e.jsplumbDefaults),e.jsPlumb.setSuspendDrawing(!1,!0),Z(),e.jsPlumb.bind("contextmenu",(o,l)=>{l.preventDefault();const{sourceId:t,targetId:i}=o,{clientX:n,clientY:s}=l;e.dropdownLine.x=n,e.dropdownLine.y=s;const a=e.jsplumbData.nodeList.find(f=>f.nodeId===i),c=e.jsplumbData.lineList.find(f=>f.sourceId===t&&f.targetId===i);a.type="line",a.label=c.label,N.value.openContextmenu(a,o)}),e.jsPlumb.bind("beforeDrop",o=>{const{sourceId:l,targetId:t}=o;return e.jsplumbData.lineList.find(n=>n.sourceId===l&&n.targetId===t)?(h.warning("关系已存在，不可重复连接"),!1):!0}),e.jsPlumb.bind("connection",o=>{const{sourceId:l,targetId:t}=o;e.jsplumbData.lineList.push({sourceId:l,targetId:t,label:""})}),e.jsPlumb.bind("connectionDetached",o=>{const{sourceId:l,targetId:t}=o;e.jsplumbData.lineList=e.jsplumbData.lineList.filter(i=>!(i.sourceId==l&&i.targetId==t))})})},Z=()=>{e.jsplumbData.nodeList.forEach(o=>{e.jsPlumb.makeSource(o.nodeId,e.jsplumbMakeSource),e.jsPlumb.makeTarget(o.nodeId,e.jsplumbMakeTarget,E),e.jsPlumb.draggable(o.nodeId,{containment:"parent",stop:l=>{e.jsplumbData.nodeList.forEach(t=>{t.nodeId===l.el.id&&(t.left=`${l.pos[0]}px`,t.top=`${l.pos[1]}px`)})}})}),e.jsplumbData.lineList.forEach(o=>{e.jsPlumb.connect({source:o.sourceId,target:o.targetId,label:o.label},e.jsplumbConnect)})},K=o=>{o.isOpen=!o.isOpen},ee=o=>{e.jsPlumbNodeIndex=o},oe=(o,l,t)=>{e.jsPlumbNodeIndex=l;const{clientX:i,clientY:n}=t;e.dropdownNode.x=i,e.dropdownNode.y=n,o.type="node",o.label="";let s={};e.leftNavList.forEach(a=>{a.children&&a.children.find(c=>c.id===o.id)&&(s=a.children.find(c=>c.id===o.id))}),o.from=s.form,R.value.openContextmenu(o)},ne=o=>{const{contextMenuClickId:l,nodeId:t}=o;if(l===0){const i=e.jsplumbData.nodeList.findIndex(n=>n.nodeId===t);e.jsplumbData.nodeList.splice(i,1),e.jsPlumb.removeAllEndpoints(t),e.jsPlumbNodeIndex=null}else l===1&&j.value.open(o)},te=(o,l)=>{const{contextMenuClickId:t}=o,{endpoints:i}=l,n=[];i.forEach(s=>{n.push({id:s.element.id,innerText:s.element.innerText})}),o.contact=`${n[0].innerText}(${n[0].id}) => ${n[1].innerText}(${n[1].id})`,t===0?e.jsPlumb.deleteConnection(l):t===1&&j.value.open(o,l)},le=o=>{const{sourceId:l,targetId:t,label:i}=o,n=e.jsPlumb.getConnections({source:l,target:t})[0];n.setLabel(i),!i||i===""?n.addClass("workflow-right-empty-label"):(n.removeClass("workflow-right-empty-label"),n.addClass("workflow-right-label")),e.jsplumbData.lineList.forEach(s=>{s.sourceId===l&&s.targetId===t&&(s.label=i)})},se=o=>{const{nodeId:l,name:t,icon:i}=o;e.jsplumbData.nodeList.forEach(n=>{n.nodeId===l&&(n.name=t,n.icon=i)}),k(()=>{e.jsPlumb.setSuspendDrawing(!1,!0)})},ie=o=>{switch(o){case"help":ae();break;case"download":re();break;case"submit":de();break;case"copy":ce();break;case"del":ue();break;case"fullscreen":pe();break}},ae=()=>{k(()=>{O.value.open()})},re=()=>{const{globalTitle:o}=X.value,l="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e.jsplumbData,null,"	")),t=document.createElement("a");t.setAttribute("href",l),t.setAttribute("download",`${o}工作流.json`),t.click(),t.remove(),h.success("下载成功")},de=()=>{h.success("数据提交成功")},ce=()=>{Y(JSON.stringify(e.jsplumbData))},ue=()=>{Ie.confirm("此操作将清空画布，是否继续？","提示",{confirmButtonText:"清空",cancelButtonText:"取消"}).then(()=>{e.jsplumbData.nodeList.forEach(o=>{e.jsPlumb.removeAllEndpoints(o.nodeId)}),k(()=>{e.jsplumbData={nodeList:[],lineList:[]},h.success("清空画布成功")})}).catch(()=>{})},pe=()=>{H.setCurrenFullscreen(!0)};return ke(async()=>{await U(),G(),Q(),x(),window.addEventListener("resize",x)}),_e(()=>{window.removeEventListener("resize",x)}),(o,l)=>{const t=q("SvgIcon"),i=q("el-scrollbar");return u(),p("div",Ne,[e.isShow?(u(),p("div",Oe)):je("",!0),r("div",Me,[r("div",qe,[d(b(W),{onTool:ie}),r("div",ze,[r("div",Ae,[d(i,null,{default:xe(()=>[(u(!0),p(C,null,D(e.leftNavList,n=>(u(),p("div",{ref_for:!0,ref_key:"leftNavRefs",ref:v,key:n.id,style:A({height:n.isOpen?"auto":"50px",overflow:"hidden"}),class:"workflow-left-id"},[r("div",{class:"workflow-left-title",onClick:s=>K(n)},[r("span",null,P(n.title),1),d(t,{name:n.isOpen?"ele-ArrowDown":"ele-ArrowRight"},null,8,["name"])],8,Be),(u(!0),p(C,null,D(n.children,(s,a)=>(u(),p("div",{class:"workflow-left-item",key:a,"data-name":s.name,"data-icon":s.icon,"data-id":s.id},[r("div",We,[d(t,{name:s.icon,class:"workflow-icon-drag"},null,8,["name"]),r("div",Ve,P(s.name),1)])],8,$e))),128))],4))),128))]),_:1})]),r("div",{class:"workflow-right",ref_key:"workflowRightRef",ref:S},[(u(!0),p(C,null,D(e.jsplumbData.nodeList,(n,s)=>(u(),p("div",{key:n.nodeId,id:n.nodeId,"data-node-id":n.nodeId,class:B(n.class),style:A({left:n.left,top:n.top}),onClick:a=>ee(s),onContextmenu:Le(a=>oe(n,s,a),["prevent"])},[r("div",{class:B(["workflow-right-box",{"workflow-right-active":e.jsPlumbNodeIndex===s}])},[r("div",He,[d(t,{name:n.icon,class:"workflow-icon-drag"},null,8,["name"]),r("div",Je,P(n.name),1)])],2)],46,Fe))),128))],512)])])]),d(b(T),{dropdown:e.dropdownNode,ref_key:"contextmenuNodeRef",ref:R,onCurrent:ne},null,8,["dropdown"]),d(b(T),{dropdown:e.dropdownLine,ref_key:"contextmenuLineRef",ref:N,onCurrent:te},null,8,["dropdown"]),d(b(V),{ref_key:"drawerRef",ref:j,onLabel:le,onNode:se},null,512),d(b(F),{ref_key:"helpRef",ref:O},null,512)])}}}),oo=Ee(Ye,[["__scopeId","data-v-9a982f19"]]);export{oo as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./index-2I_VfyMC.js","./store-dof5ccn5.js","../css/store-dzCp3yyn.css","./index-xdJ7pE-g.js","../css/index-5Z0pdBTT.css","./_plugin-vue_export-helper-x3n3nnut.js","../css/index-LUoJIjYA.css","./index-BU-UcL8B.js","../css/index-nXs9UJVs.css","./index-svnCK73e.js","./help-mDTpprs3.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}

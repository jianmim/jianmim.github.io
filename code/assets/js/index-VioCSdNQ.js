import{c as F}from"./commonFunction-_vykxDAa.js";import{g as b}from"./index-lw7p-_pG.js";import{S as w}from"./sys-notice-api-hm-uSLi9.js";import{k as P,L as M,p as R,t as i,a6 as A,x as d,M as H,D as t,A as a,S as r,B as I,y as c,T as L,F as Q,O as v}from"./store-mQZkmHj-.js";import"./formatTime-sb5Dmd3Z.js";const $={class:"notice-container"},j=["innerHTML"],E={class:"dialog-footer"},G=P({name:"notice"}),ee=P({...G,setup(O){const{removeHtml:h}=F(),e=M({loading:!1,noticeData:[],queryParams:{title:void 0,type:void 0},tableParams:{page:1,pageSize:20,total:0},editNoticeTitle:"",dialogVisible:!1,content:""});R(async()=>{p()});const p=async()=>{var l,u;e.loading=!0;var n=await b(w).apiSysNoticePageReceivedGet(e.queryParams.title,e.queryParams.type,e.tableParams.page,e.tableParams.pageSize);e.noticeData=((l=n.data.result)==null?void 0:l.items)??[],e.tableParams.total=(u=n.data.result)==null?void 0:u.total,e.loading=!1},S=()=>{e.queryParams.title=void 0,e.queryParams.type=void 0,p()},N=n=>{e.tableParams.pageSize=n,p()},V=n=>{e.tableParams.page=n,p()},C=async n=>{e.content=n.sysNotice.content,e.dialogVisible=!0,n.readStatus=1,await b(w).apiSysNoticeSetReadPost({id:n.sysNotice.id})},k=({row:n,rowIndex:l})=>n.readStatus===1?"info-row":"";return(n,l)=>{const u=i("el-input"),g=i("el-form-item"),y=i("el-option"),z=i("el-select"),m=i("el-button"),x=i("el-button-group"),q=i("el-form"),f=i("el-card"),s=i("el-table-column"),_=i("el-tag"),D=i("el-table"),T=i("el-pagination"),B=i("el-dialog"),U=A("loading");return d(),H("div",$,[t(f,{shadow:"hover","body-style":{paddingBottom:"0"}},{default:a(()=>[t(q,{model:e.queryParams,ref:"queryForm",inline:!0},{default:a(()=>[t(g,{label:"标题"},{default:a(()=>[t(u,{modelValue:e.queryParams.title,"onUpdate:modelValue":l[0]||(l[0]=o=>e.queryParams.title=o),placeholder:"标题",clearable:""},null,8,["modelValue"])]),_:1}),t(g,{label:"类型"},{default:a(()=>[t(z,{modelValue:e.queryParams.type,"onUpdate:modelValue":l[1]||(l[1]=o=>e.queryParams.type=o),placeholder:"类型",clearable:""},{default:a(()=>[t(y,{label:"通知",value:1}),t(y,{label:"公告",value:2})]),_:1},8,["modelValue"])]),_:1}),t(g,null,{default:a(()=>[t(x,null,{default:a(()=>[t(m,{type:"primary",icon:"ele-Search",onClick:p},{default:a(()=>[r(" 查询 ")]),_:1}),t(m,{icon:"ele-Refresh",onClick:S},{default:a(()=>[r(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(f,{class:"full-table",shadow:"hover",style:{"margin-top":"8px"}},{default:a(()=>[I((d(),c(D,{data:e.noticeData,style:{width:"100%"},border:"","row-class-name":k},{default:a(()=>[t(s,{type:"index",label:"序号",width:"55",align:"center"}),t(s,{prop:"sysNotice.title",label:"标题","header-align":"center","show-overflow-tooltip":""}),t(s,{prop:"sysNotice.content",label:"内容","header-align":"center","show-overflow-tooltip":""},{default:a(o=>[r(L(Q(h)(o.row.sysNotice.content)),1)]),_:1}),t(s,{prop:"sysNotice.type",label:"类型",width:"100",align:"center","show-overflow-tooltip":""},{default:a(o=>[o.row.sysNotice.type===1?(d(),c(_,{key:0},{default:a(()=>[r(" 通知 ")]),_:1})):(d(),c(_,{key:1,type:"warning"},{default:a(()=>[r(" 公告 ")]),_:1}))]),_:1}),t(s,{prop:"sysNotice.createTime",label:"创建时间",align:"center","show-overflow-tooltip":""}),t(s,{prop:"readStatus",label:"阅读状态",width:"100",align:"center","show-overflow-tooltip":""},{default:a(o=>[o.row.readStatus===1?(d(),c(_,{key:0,type:"info"},{default:a(()=>[r(" 已读 ")]),_:1})):(d(),c(_,{key:1,type:"danger"},{default:a(()=>[r(" 未读 ")]),_:1}))]),_:1}),t(s,{prop:"sysNotice.publicUserName",label:"发布者",align:"center","show-overflow-tooltip":""}),t(s,{prop:"sysNotice.publicTime",label:"发布时间",align:"center","show-overflow-tooltip":""}),t(s,{label:"操作",width:"80",fixed:"right",align:"center","show-overflow-tooltip":""},{default:a(o=>[t(m,{icon:"ele-InfoFilled",size:"small",text:"",type:"primary",onClick:J=>C(o.row)},{default:a(()=>[r(" 详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[U,e.loading]]),t(T,{currentPage:e.tableParams.page,"onUpdate:currentPage":l[2]||(l[2]=o=>e.tableParams.page=o),"page-size":e.tableParams.pageSize,"onUpdate:pageSize":l[3]||(l[3]=o=>e.tableParams.pageSize=o),total:e.tableParams.total,"page-sizes":[10,20,50,100],small:"",background:"",onSizeChange:N,onCurrentChange:V,layout:"total, sizes, prev, pager, next, jumper"},null,8,["currentPage","page-size","total"])]),_:1}),t(B,{modelValue:e.dialogVisible,"onUpdate:modelValue":l[5]||(l[5]=o=>e.dialogVisible=o),title:"消息详情",draggable:"",width:"769px"},{footer:a(()=>[v("span",E,[t(m,{type:"primary",onClick:l[4]||(l[4]=o=>e.dialogVisible=!1)},{default:a(()=>[r("确认")]),_:1})])]),default:a(()=>[v("p",{innerHTML:e.content},null,8,j)]),_:1},8,["modelValue"])])}}});export{ee as default};

import{k as R,r as E,L as B,p as Y,t as n,a6 as Z,x as d,M as ee,D as t,A as e,F,aj as te,B as k,y as f,S as a,G as le,T as y,i as L,n as ae,ai as A,E as N,_ as P}from"./store-dof5ccn5.js";import{_ as oe,S as v}from"./editConfig.vue_vue_type_script_setup_true_name_sysEditConfig_lang-m1m6wxX-.js";import{g as D}from"./index-xdJ7pE-g.js";import{a as ne}from"./authFunction-Sl3GZ0Ah.js";const re={class:"sys-config-container"},se=R({name:"sysConfig"}),_e=R({...se,setup(ie){const $=L(()=>P(()=>import("./index-Xy3CU_sQ.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url)),I=L(()=>P(()=>import("./search-_HzKEYd9.js"),__vite__mapDeps([7,1,2,5,8]),import.meta.url)),w=E(),g=E(),r=B({editConfigTitle:"",selectlist:[],groupList:[]}),c=B({tableData:{columns:[{prop:"name",minWidth:150,label:"配置名称",headerAlign:"center",sortable:"custom",isCheck:!0,hideCheck:!0},{prop:"code",minWidth:150,label:"配置编码",headerAlign:"center",toolTip:!0,sortable:"custom",isCheck:!0},{prop:"value",minWidth:150,label:"属性值",headerAlign:"center",isCheck:!0},{prop:"sysFlag",width:100,label:"内置参数",align:"center",isCheck:!0},{prop:"groupCode",width:120,label:"分组编码",align:"center",sortable:"custom",isCheck:!0},{prop:"orderNo",width:80,label:"排序",align:"center",sortable:"custom",isCheck:!0},{prop:"remark",width:100,label:"修改记录",align:"center",headerAlign:"center",showOverflowTooltip:!0,isCheck:!0},{prop:"action",width:140,label:"操作",type:"action",align:"center",isCheck:!0,fixed:"right",hideCheck:!0}],config:{isStripe:!0,isBorder:!1,isSerialNo:!0,isSelection:!0,showSelection:ne("sysConfig:batchDelete"),pageSize:20,hideExport:!1,exportFileName:"系统参数"},search:[{label:"配置名称",prop:"name",placeholder:"搜索配置名称",required:!1,type:"input"},{label:"配置编码",prop:"code",placeholder:"搜索配置编码",required:!1,type:"input"}],param:{},defaultSort:{prop:"orderNo",order:"ascending"}}}),U=l=>D(v).apiSysConfigPagePost(l).then(o=>o.data),V=l=>(l.forEach(o=>{o.sysFlag=o.sysFlag==1?"是":"否"}),l),G=l=>{c.tableData.columns=l},M=l=>{c.tableData.param=Object.assign({},c.tableData.param,{...l}),ae(()=>{g.value.pageReset()})},T=async()=>{var u;const l=await D(v).apiSysConfigGroupListGet(),o={label:"分组编码",prop:"groupCode",placeholder:"请选择",required:!1,type:"select",options:[]};r.groupList=l.data.result??[],(u=l.data.result)==null||u.forEach(s=>{var C;(C=o.options)==null||C.push({label:s,value:s})});let m=c.tableData.search.filter(s=>s.prop=="groupCode");m.length==0?c.tableData.search.push(o):m[0]=o},O=l=>{r.selectlist=l};Y(async()=>{T()});const q=()=>{g.value.handleList(),T()},z=()=>{var l;r.editConfigTitle="添加配置",(l=w.value)==null||l.openDialog({sysFlag:2,orderNo:100})},W=l=>{var o;r.editConfigTitle="编辑配置",(o=w.value)==null||o.openDialog(l)},j=l=>{A.confirm(`确定删除配置：【${l.name}】?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await D(v).apiSysConfigDeletePost({id:l.id}),g.value.handleList(),N.success("删除成功")}).catch(()=>{})},H=()=>{if(r.selectlist.length==0)return!1;A.confirm(`确定批量删除【${r.selectlist[0].name}】等${r.selectlist.length}个配置?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{const l=r.selectlist.map(o=>o.id);await D(v).apiSysConfigBatchDeletePost(l),g.value.pageReset(),N.success("删除成功")}).catch(()=>{})};return(l,o)=>{const m=n("el-card"),u=n("el-button"),s=n("el-tag"),C=n("ele-InfoFilled"),p=n("el-icon"),_=n("el-text"),x=n("ele-UserFilled"),h=n("el-descriptions-item"),S=n("ele-Calendar"),J=n("ele-Tickets"),K=n("el-descriptions"),Q=n("el-popover"),b=Z("auth");return d(),ee("div",re,[t(m,{shadow:"hover","body-style":{paddingBottom:"0"}},{default:e(()=>[t(F(I),{search:c.tableData.search,onSearch:M},null,8,["search"])]),_:1}),t(m,{class:"full-table",shadow:"hover",style:{"margin-top":"8px"}},{default:e(()=>[t(F($),te({ref_key:"tableRef",ref:g},c.tableData,{getData:U,exportChangeData:V,onSortHeader:G,onSelectionChange:O,border:""}),{command:e(()=>[k((d(),f(u,{type:"primary",icon:"ele-Plus",onClick:z},{default:e(()=>[a(" 新增 ")]),_:1})),[[b,"sysConfig:add"]]),r.selectlist.length>0?k((d(),f(u,{key:0,type:"danger",icon:"ele-Delete",onClick:H},{default:e(()=>[a(" 批量删除 ")]),_:1})),[[b,"sysConfig:batchDelete"]]):le("",!0)]),sysFlag:e(i=>[i.row.sysFlag===1?(d(),f(s,{key:0},{default:e(()=>[a(" 是 ")]),_:1})):(d(),f(s,{key:1,type:"danger"},{default:e(()=>[a(" 否 ")]),_:1}))]),remark:e(i=>[t(Q,{placement:"bottom",width:"280",trigger:"hover"},{reference:e(()=>[t(_,{type:"primary"},{default:e(()=>[t(p,null,{default:e(()=>[t(C)]),_:1}),a("详情 ")]),_:1})]),default:e(()=>[t(K,{direction:"vertical",column:2,border:""},{default:e(()=>[t(h,{width:"140"},{label:e(()=>[t(_,null,{default:e(()=>[t(p,null,{default:e(()=>[t(x)]),_:1}),a("创建者 ")]),_:1})]),default:e(()=>[t(s,null,{default:e(()=>[a(y(i.row.createUserName??"无"),1)]),_:2},1024)]),_:2},1024),t(h,null,{label:e(()=>[t(_,null,{default:e(()=>[t(p,null,{default:e(()=>[t(S)]),_:1}),a("创建时间 ")]),_:1})]),default:e(()=>[t(s,null,{default:e(()=>[a(y(i.row.createTime??"无"),1)]),_:2},1024)]),_:2},1024),t(h,null,{label:e(()=>[t(_,null,{default:e(()=>[t(p,null,{default:e(()=>[t(x)]),_:1}),a("修改者 ")]),_:1})]),default:e(()=>[t(s,null,{default:e(()=>[a(y(i.row.updateUserName??"无"),1)]),_:2},1024)]),_:2},1024),t(h,null,{label:e(()=>[t(_,null,{default:e(()=>[t(p,null,{default:e(()=>[t(S)]),_:1}),a("修改时间 ")]),_:1})]),default:e(()=>[t(s,null,{default:e(()=>[a(y(i.row.updateTime??"无"),1)]),_:2},1024)]),_:2},1024),t(h,null,{label:e(()=>[t(_,null,{default:e(()=>[t(p,null,{default:e(()=>[t(J)]),_:1}),a("备注 ")]),_:1})]),default:e(()=>[a(" "+y(i.row.remark),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),action:e(i=>[k((d(),f(u,{icon:"ele-Edit",size:"small",text:"",type:"primary",onClick:X=>W(i.row)},{default:e(()=>[a(" 编辑 ")]),_:2},1032,["onClick"])),[[b,"sysConfig:update"]]),k((d(),f(u,{icon:"ele-Delete",size:"small",text:"",type:"danger",onClick:X=>j(i.row)},{default:e(()=>[a(" 删除 ")]),_:2},1032,["onClick"])),[[b,"sysConfig:delete"]])]),_:1},16)]),_:1}),t(oe,{ref_key:"editConfigRef",ref:w,title:r.editConfigTitle,groupList:r.groupList,onUpdateData:q},null,8,["title","groupList"])])}}});export{_e as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./index-Xy3CU_sQ.js","./store-dof5ccn5.js","../css/store-dzCp3yyn.css","./index-xdJ7pE-g.js","../css/index-5Z0pdBTT.css","./_plugin-vue_export-helper-x3n3nnut.js","../css/index-1IhrFRfH.css","./search-_HzKEYd9.js","../css/search-PIgyaeN5.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
